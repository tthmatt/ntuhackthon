<!DOCTYPE html><html lang="en"><head><title>What Is Stash - Build an Investment Portfolio | Stash Invest</title><meta charset="utf-8"><link rel="stylesheet" href="/assets/css/reset.css"><link rel="stylesheet" href="/assets/css/style.css"><!--link(href='https://fonts.googleapis.com/css?family=Lato:300,400,600,700,800', rel='stylesheet')--><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="manifest" href="/manifest.json"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#472086"><meta name="theme-color" content="#ffffff"><meta property="og:title" content="What Is Stash - Build an Investment Portfolio | Stash Invest"><meta property="og:description" content="What makes Stash different than other investment apps? With Stash, you can build a portfolio that reflects your unique beliefs, interests, and goals."><meta property="og:image" content="https://cdn.stashinvest.com/open-graph.png"><meta property="og:site_name" content="Stash"><meta name="twitter:title" content="What Is Stash - Build an Investment Portfolio | Stash Invest"><meta name="twitter:description" content="What makes Stash different than other investment apps? With Stash, you can build a portfolio that reflects your unique beliefs, interests, and goals."><meta name="twitter:image" content="https://cdn.stashinvest.com/open-graph.png"><meta name="twitter:url" content="https://www.stashinvest.com/why-stash"><meta property="og:url" content="https://www.stashinvest.com/why-stash"><link rel="canonical" href="https://www.stashinvest.com/why-stash"><script>window.stashEnv = {
	environment: 'production',
	appHost: 'https://app.stashinvest.com',
	signUpURL: 'https://get.stashinvest.com/website-webreg'+window.location.search,
	cdn: 'https://cdn.stashinvest.com/',
	stashApi: 'https://api.stashinvest.com/api/v1',
	branchKey: 'key_live_khjO8udET5Lp36DkH5uC5jbkrFkjXRq9'
}</script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script><script>(function($,T,A,S,H){$[S]=$[S]||[];$[S].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=T.getElementsByTagName(A)[0],auth=$.location.host.match(/^\w+-/)?'&gtm_auth=Th3olOQ13l_KJTBEcUGWjg&gtm_preview=env-3&gtm_cookies_win=x':'',j=T.createElement(A),dl=S!='dataLayer'?'&l='+S:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+H+dl+auth;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-TFGKH8');
</script><script>$(document).ready(function() {
	$('.get-stash').attr('href', window.stashEnv.signUpURL)
})
</script><script src="//d3js.org/d3.v3.min.js"></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TFGKH8" height="0" width="0" style="display:none;visibility:hidden;"></iframe></noscript><style>/* Header and Navigation
---------------------------------------------------- */
header {
  padding: 2em 0;
  position: relative;
  position: fixed;
  top: 0;
  right: 0;
  left: 0;
  width: 100%;
  box-sizing: border-box;
  z-index: 9;
  font-size: 0.938em;
  -webkit-transition: background 0.2s;
  -moz-transition: background 0.2s;
  transition: background 0.2s;
}
header h1,
header h1 a {
  width: 99px;
  height: 29px;
}
header h1 {
  position: relative;
  z-index: 1;
}
header h1 a {
  display: block;
  text-indent: -9999em;
  background: url('https://cdn.stashinvest.com/assets/images/globals/logo.svg') no-repeat top left;
  background-size: 100%;
}
header h1 a:after {
  display: none;
}
header a {
  color: rgba(255, 255, 255, 0.6);
  font-family: arial, sans-serif;
  position: relative;
  display: block;
  padding: 5px 0;
}
header a:after {
  content: '';
  display: block;
  bottom: 0;
  height: 1px;
  background: #FFF;
  width: 0;
  left: 50%;
  transform: translateX(-50%);
  -webkit-transition: all 0.2s;
  -moz-transition: all 0.2s;
  transition: all 0.2s;
  position: absolute;
}
header a:hover,
header a.active {
  color: #ffffff;
}
header a:hover:after,
header a.active:after {
  width: 100%;
}
header nav {
  position: absolute;
  text-align: left;
  top: 50%;
  left: 140px;
  margin-top: -13px;
}
header nav li {
  display: inline-block;
  padding: 0 20px;
}
header .btn {
  position: absolute;
  right: 30px;
  top: 50%;
  line-height: 1;
  margin-top: -17px;
  padding: 12px 16px;
}
header .btn:after {
  display: none;
}
header .contact {
  position: absolute;
  right: 160px;
  top: 50%;
  margin-top: -13px;
}
#secondary header {
  background: #42218a;
}
header.scrolled,
#secondary header.scrolled {
  background: #FFF;
  box-shadow: 0 2px 15px rgba(0, 0, 0, 0.15);
}
header.scrolled a,
#secondary header.scrolled a {
  color: rgba(0, 0, 0, 0.7);
}
header.scrolled a:hover,
#secondary header.scrolled a:hover {
  color: rgba(0, 0, 0, 0.75);
}
header.scrolled a:after,
#secondary header.scrolled a:after {
  background: rgba(0, 0, 0, 0.75);
}
header.scrolled a.btn,
#secondary header.scrolled a.btn {
  color: #FFF;
}
header.scrolled a.btn:hover,
#secondary header.scrolled a.btn:hover {
  color: #FFF;
}
header.scrolled h1 a,
#secondary header.scrolled h1 a {
  background-image: url('https://cdn.stashinvest.com/assets/images/globals/logo-purple.svg');
}
@media only screen and (max-width: 800px) {
  header nav li {
    padding: 0 15px;
  }
}
@media only screen and (max-width: 768px) {
  header {
    padding: 20px;
  }
  header h1 {
    margin: 0 auto;
    position: relative;
    z-index: 2000;
  }
  header nav {
    background: #49218a;
    position: fixed;
    left: 0;
    width: 100%;
    z-index: 900;
    height: 0;
    top: 0;
    overflow: hidden;
    margin-top: 0;
    -webkit-transition: height 0.5s, padding 0.5s;
    -moz-transition: height 0.5s, padding 0.5s;
    -o-transition: height 0.5s, padding 0.5s;
    transition: height 0.5s, padding 0.5s;
  }
  header nav ul {
    position: absolute;
    width: 100%;
  }
  header nav li {
    float: none;
    display: block;
  }
  header nav li a {
    text-align: center;
    padding: 15px 0;
    font-size: 20px;
    font-weight: bold;
  }
  header nav li a:after {
    display: none;
  }
  header nav li.mobile {
    text-align: center;
  }
  header nav li.mobile a {
    position: initial;
    font-size: 16px;
    font-weight: bold;
    color: rgba(255, 255, 255, 0.6);
    padding: .55em 1.64em;
  }
  header nav li.mobile a:hover {
    color: #ffffff;
  }
  header nav li.mobile.get-stash {
    width: 129px;
    height: 40px;
    border: 1px solid white;
    padding: 0;
    border-radius: 50px;
    margin: 65px auto 0;
  }
  header nav li.mobile.get-stash:hover {
    background-color: #f5a623;
    border: 1px solid #f5a623;
  }
  header nav li.mobile.signin {
    margin-bottom: 150px;
  }
  header .btn {
    left: 10px;
    right: auto;
    z-index: 2000;
    padding: 0.5em .75em;
    text-align: center;
    font-size: 0.875em;
    letter-spacing: 0;
    background: transparent;
    border: 1px solid #FFF !important;
    margin-top: -13px;
  }
  header .wrap {
    position: static;
  }
  header.scrolled nav li.mobile a {
    color: rgba(0, 0, 0, 0.7);
  }
  header.scrolled nav li.mobile.get-stash {
    border: 1px solid rgba(0, 0, 0, 0.7);
  }
  header.scrolled a.btn,
  header.scrolled a.btn:hover {
    border: 1px solid #49218a !important;
    color: #49218a !important;
  }
  .openMenu header nav {
    height: 100vh;
    padding-top: 69px;
    overflow: scroll;
  }
  .openMenu,
  .openOverlay {
    overflow-y: hidden;
  }
  .openMenu header nav ul {
    -webkit-animation-duration: 1s;
    animation-duration: 1s;
    -webkit-animation-fill-mode: both;
    animation-fill-mode: both;
    -webkit-animation-delay: .3s;
    animation-delay: .3s;
    -webkit-animation-name: fadeInNav;
    animation-name: fadeInNav;
  }
  #menu {
    position: absolute;
    top: 0;
    padding: 35px 20px;
    right: 0;
    font-size: 25px;
    display: block;
    z-index: 1000;
  }
  #menu span {
    display: block;
    width: 30px;
    height: 2px;
    border-radius: 2px;
    background: #FFF;
    -webkit-transition: all 0.3s;
    -moz-transition: all 0.3s;
    -o-transition: all 0.3s;
    transition: all 0.3s;
  }
  #menu:after {
    display: none;
  }
  #menu span:after,
  #menu span:before {
    content: '';
    display: block;
    width: 30px;
    height: 2px;
    background: #FFF;
    position: absolute;
    -webkit-transition: all 0.3s;
    -moz-transition: all 0.3s;
    -o-transition: all 0.3s;
    transition: all 0.3s;
  }
  #menu span:before {
    margin-top: -10px;
    border-radius: 2px;
  }
  #menu span:after {
    margin-top: 10px;
    border-radius: 2px;
  }
  .openMenu #menu span {
    background: transparent !important;
  }
  .openMenu #menu span:after {
    margin: 0;
    -webkit-transform: rotate(-45deg);
    -moz-transform: rotate(-45deg);
    -ms-transform: rotate(-45deg);
    -o-transform: rotate(-45deg);
    transform: rotate(-45deg);
  }
  .openMenu #menu span:before {
    margin: 0;
    -webkit-transform: rotate(45deg);
    -moz-transform: rotate(45deg);
    -ms-transform: rotate(45deg);
    -o-transform: rotate(45deg);
    transform: rotate(45deg);
  }
  .scrolled nav {
    background: #FFF;
  }
  .scrolled #menu span {
    background: #49218a;
  }
  .scrolled #menu span:after,
  .scrolled #menu span:before {
    background: #49218a;
  }
}
@keyframes fadeInNav {
  0% {
    opacity: 0;
    transform: translateY(-30px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}
</style><script>$(document).ready(function() {
	$('.get-stash').attr('href', window.stashEnv.signUpURL)
	
	$('#menu').bind('touchstart mousedown', function(event){
	    event.preventDefault();
	    if ($('body').attr('class') != "openMenu") {
			$('header .btn').css('display', 'none')
		} else {
			$('header .btn').css('display', 'block')
		}

	});
})</script><header><div class="wrap"><h1><a href="/">Stash Invest</a></h1><a href="javascript:void(0);" id="menu"><span></span></a><nav><ul><li><a class="active" href="/why-stash">Why Stash?</a></li><li><a href="/pricing">Pricing</a></li><li><a href="https://learn.stashinvest.com/">Learn</a></li><li><a href="/retire">Retire</a></li><li><a href="https://ask.stashinvest.com/">Support</a></li><li class="mobile get-stash"><a href="https://app.stashinvest.com/sign-up">Get Stash</a></li><li class="mobile signin"><a href="https://app.stashinvest.com/log-in">Sign In</a></li></ul></nav><a class="contact desktop" href="https://app.stashinvest.com/log-in">Sign In</a><a class="get-stash btn" href="https://app.stashinvest.com/sign-up">Get Stash</a></div></header><style>/* Banner 
-------------------------------------------------------- */
.banner {
  box-sizing: border-box;
  padding: 0;
  overflow: hidden;
  position: relative;
  background: url('https://cdn.stashinvest.com/assets/images/why-stash/mobile-bg.jpg') no-repeat center;
  background-size: cover;
}
.banner .video-wrap {
  position: relative;
  top: 0;
  width: 100%;
  height: 100%;
  min-height: 200px;
  padding-bottom: 20%;
}
.banner .video-wrap video {
  width: 100%;
  position: absolute;
  top: 50%;
  -webkit-transform: translate(0, -50%);
  transform: translate(0, -50%);
}
@media only screen and (max-width: 767px) {
  .banner .video-wrap {
    display: none;
  }
}
@media only screen and (max-width: 767px) {
  .banner {
    height: 22em;
  }
}
@media only screen and (max-width: 400px) {
  .banner {
    height: 17em;
  }
}
.why-stash {
  text-align: center;
}
.why-stash h1 {
  text-transform: uppercase;
  font-family: 'Walsheim', sans-serif;
  font-weight: 300;
  color: #828282;
  font-size: 15px;
  padding-bottom: 10px;
}
@-moz-document url-prefix() {
  .why-stash h2 {
    font-weight: 400;
  }
}
.why-stash p {
  max-width: 640px;
  margin: 0 auto;
  line-height: 1.5;
}
@media only screen and (max-width: 767px) {
  .why-stash p {
    text-align: left;
  }
}
.portfolios {
  color: #fff;
  background: linear-gradient(180deg, #5d4eb0, #4dbbdd) no-repeat;
}
.portfolios .intro {
  text-align: center;
}
.portfolios .intro h2 {
  color: #fff;
}
@-moz-document url-prefix() {
  .portfolios .intro h2 {
    font-weight: 400;
  }
}
.portfolios .intro p {
  max-width: 640px;
  line-height: 1.5;
  margin: 0 auto 3em auto;
}
@media only screen and (max-width: 767px) {
  .portfolios .intro p {
    text-align: left;
  }
}
.portfolios .investor {
  text-align: center;
  padding: 6% 0;
}
.portfolios .investor .icon {
  display: inline-block;
  width: 3em;
  height: 3em;
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
}
.portfolios .investor.activist .icon {
  background-image: url('https://cdn.stashinvest.com/assets/images/why-stash/activist.svg');
}
.portfolios .investor.trendsetter .icon {
  background-image: url('https://cdn.stashinvest.com/assets/images/why-stash/trendsetter.svg');
}
.portfolios .investor.globetrotter .icon {
  background-image: url('https://cdn.stashinvest.com/assets/images/why-stash/globetrotter.svg');
}
.portfolios .investor.techie .icon {
  background-image: url('https://cdn.stashinvest.com/assets/images/why-stash/techie.svg');
}
.portfolios .investor h3 {
  margin: 0;
  padding: 0 0 0.3em 0;
  border-bottom: 1px solid #ffffff;
  display: inline-block;
  color: #fff;
  font-size: 1.5em;
  font-weight: 600;
  margin: 0 auto;
}
.portfolios .investor .investments {
  padding: 2em 0;
  display: flex;
  align-items: center;
  font-weight: 300;
}
@media only screen and (max-width: 767px) {
  .portfolios .investor .investments {
    flex-direction: column;
  }
}
.portfolios figure,
.portfolios .investment {
  display: inline-block;
  width: 46%;
  vertical-align: middle;
}
.portfolios figure {
  position: relative;
}
.portfolios figure svg {
  width: 100%;
  padding: 1em 0;
}
.portfolios figure::after {
  content: "";
  position: absolute;
  display: block;
  width: 100%;
  height: 7em;
  background: url('assets/images/why-stash/shadow.png') no-repeat center;
  background-size: 100% 100%;
}
@media only screen and (max-width: 767px) {
  .portfolios figure {
    order: 1;
  }
}
.portfolios .investment {
  margin: 0 3%;
  text-align: left;
}
.portfolios .investment .investment-header {
  font-family: 'Walsheim', sans-serif;
  font-weight: 300;
  text-transform: uppercase;
}
.portfolios .investment .investment-name {
  font-family: 'Walsheim', sans-serif;
  font-weight: 600;
  font-size: 1.25em;
  margin-bottom: 0.5em;
}
@-moz-document url-prefix() {
  .portfolios .investment .investment-name {
    font-weight: 400;
  }
}
.portfolios .investment .investment-description {
  padding-bottom: 2em;
  font-weight: 300;
}
.portfolios .investment .investment-exposures {
  padding-top: 0.5em;
}
@media only screen and (max-width: 767px) {
  .portfolios .investment {
    order: 2;
  }
}
.center.cta .wrap h3 {
  color: #333;
  font-weight: 500;
}
.center.cta .wrap .btn {
  font-family: 'Walsheim';
  font-weight: 400;
}
@-moz-document url-prefix() {
  .center.cta .wrap .btn {
    font-weight: 300;
  }
}
@supports (animation: spin 1s forwards) {
  .investor .investments {
    opacity: 0;
    transition: opacity 0.3s 0.5s;
  }
  .investor .investments g[class$='pieChart'] {
    -webkit-transform: scale(0.7);
    transform: scale(0.7);
  }
  .investor .investments.viewed {
    opacity: 1;
  }
  .investor .investments.viewed g[class$='pieChart'] {
    animation: spin 1.5s 0.5s forwards;
  }
}
@keyframes spin {
  from {
    -webkit-transform: rotate(-360deg) scale(0.7);
    transform: rotate(-360deg) scale(0.7);
  }
  to {
    -webkit-transform: rotate(0deg) scale(1);
    transform: rotate(0deg) scale(1);
  }
}
@media only screen and (max-width: 768px) {
  .portfolios figure,
  .portfolios .investment {
    width: initial;
  }
}
</style><section class="banner"><div class="video-wrap"><video poster="https://cdn.stashinvest.com/assets/images/why-stash/poster.jpg" autoplay muted loop><source src="https://cdn.stashinvest.com/assets/images/why-stash/stash.webm" type="video/webm"><source src="https://cdn.stashinvest.com/assets/images/why-stash/stash.mp4" type="video/mp4"><img src="https://cdn.stashinvest.com/assets/images/why-stash/poster.jpg"></video></div></section><section class="why-stash"><div class="wrap"><h1>Why invest with Stash?</h1><h2>Stash is investing, simplified.</h2><p>Instead of relying on a black box to invest your money, you can learn how to invest yourself. We give you the choices, tools, and tips you need to build a portfolio that reflects who you are.</p></div></section><script>// note: this has been forked from the original d3pie library. careful if updating.

/*!
 * d3pie
 * @author Ben Keen
 * @version 0.1.8
 * @date May 1st, 2015
 * @repo http://github.com/benkeen/d3pie
 */

// UMD pattern from https://github.com/umdjs/umd/blob/master/returnExports.js
(function(root, factory) {
  if (typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module
    define([], factory);
  } else if (typeof exports === 'object') {
    // Node. Does not work with strict CommonJS, but only CommonJS-like environments that support module.exports,
    // like Node
    module.exports = factory(require());
  } else {
    // browser globals (root is window)
    root.d3pie = factory(root);
  }
}(this, function() {

	var _scriptName = "d3pie";
	var _version = "0.1.6";

	// used to uniquely generate IDs and classes, ensuring no conflict between multiple pies on the same page
	var _uniqueIDCounter = 0;


	// this section includes all helper libs on the d3pie object. They're populated via grunt-template. Note: to keep
	// the syntax highlighting from getting all messed up, I commented out each line. That REQUIRES each of the files
	// to have an empty first line. Crumby, yes, but acceptable.
	//// --------- _default-settings.js -----------/**
/**
 * Contains the out-the-box settings for the script. Any of these settings that aren't explicitly overridden for the
 * d3pie instance will inherit from these. This is also included on the main website for use in the generation script.
 */
var defaultSettings = {
	header: {
		title: {
			text:     "",
			color:    "#333333",
			fontSize: 18,
			font:     "arial"
		},
		subtitle: {
			text:     "",
			color:    "#666666",
			fontSize: 14,
			font:     "arial"
		},
		location: "top-center",
		titleSubtitlePadding: 8
	},
	footer: {
		text: 	  "",
		color:    "#666666",
		fontSize: 14,
		font:     "arial",
		location: "left"
	},
	size: {
		canvasHeight: 500,
		canvasWidth: 500,
		pieInnerRadius: "0%",
		pieOuterRadius: null
	},
	data: {
		sortOrder: "value-asc",
		ignoreSmallSegments: {
			enabled: false,
			valueType: "percentage",
			value: null
		},
		smallSegmentGrouping: {
			enabled: false,
			value: 1,
			valueType: "percentage",
			label: "Other",
			color: "#cccccc"
		},
		content: []
	},
	labels: {
		outer: {
			format: "label",
			hideWhenLessThanPercentage: null,
			pieDistance: 30
		},
		inner: {
			format: "percentage",
			hideWhenLessThanPercentage: null
		},
		mainLabel: {
			color: "#333333",
			font: "arial",
			fontSize: 10
		},
		percentage: {
			color: "#dddddd",
			font: "arial",
			fontSize: 10,
			decimalPlaces: 0
		},
		value: {
			color: "#cccc44",
			font: "arial",
			fontSize: 10
		},
		lines: {
			enabled: true,
			style: "curved",
			color: "segment"
		},
		truncation: {
			enabled: false,
			truncateLength: 30
		},
    formatter: null
	},
	effects: {
		load: {
			effect: "default",
			speed: 1000
		},
		pullOutSegmentOnClick: {
			effect: "bounce",
			speed: 300,
			size: 10
		},
		highlightSegmentOnMouseover: true,
		highlightLuminosity: -0.2
	},
	tooltips: {
		enabled: false,
		type: "placeholder", // caption|placeholder
    string: "",
    placeholderParser: null,
		styles: {
      fadeInSpeed: 250,
			backgroundColor: "#000000",
      backgroundOpacity: 0.5,
			color: "#efefef",
      borderRadius: 2,
      font: "arial",
      fontSize: 10,
      padding: 4
		}
	},
	misc: {
		colors: {
			background: null,
			segments: [
				"#2484c1", "#65a620", "#7b6888", "#a05d56", "#961a1a", "#d8d23a", "#e98125", "#d0743c", "#635222", "#6ada6a",
				"#0c6197", "#7d9058", "#207f33", "#44b9b0", "#bca44a", "#e4a14b", "#a3acb2", "#8cc3e9", "#69a6f9", "#5b388f",
				"#546e91", "#8bde95", "#d2ab58", "#273c71", "#98bf6e", "#4daa4b", "#98abc5", "#cc1010", "#31383b", "#006391",
				"#c2643f", "#b0a474", "#a5a39c", "#a9c2bc", "#22af8c", "#7fcecf", "#987ac6", "#3d3b87", "#b77b1c", "#c9c2b6",
				"#807ece", "#8db27c", "#be66a2", "#9ed3c6", "#00644b", "#005064", "#77979f", "#77e079", "#9c73ab", "#1f79a7"
			],
			segmentStroke: "#ffffff"
		},
		gradient: {
			enabled: false,
			percentage: 95,
			color: "#000000"
		},
		canvasPadding: {
			top: 5,
			right: 5,
			bottom: 5,
			left: 5
		},
		pieCenterOffset: {
			x: 0,
			y: 0
		},
		cssPrefix: null
	},
	callbacks: {
		onload: null,
		onMouseoverSegment: null,
		onMouseoutSegment: null,
		onClickSegment: null
	}
};

	//// --------- validate.js -----------
var validate = {

	// called whenever a new pie chart is created
	initialCheck: function(pie) {
		var cssPrefix = pie.cssPrefix;
		var element = pie.element;
		var options = pie.options;

		// confirm d3 is available [check minimum version]
		if (!window.d3 || !window.d3.hasOwnProperty("version")) {
			console.error("d3pie error: d3 is not available");
			return false;
		}

		// confirm element is either a DOM element or a valid string for a DOM element
		if (!(element instanceof HTMLElement || element instanceof SVGElement)) {
			console.error("d3pie error: the first d3pie() param must be a valid DOM element (not jQuery) or a ID string.");
			return false;
		}

		// confirm the CSS prefix is valid. It has to start with a-Z and contain nothing but a-Z0-9_-
		if (!(/[a-zA-Z][a-zA-Z0-9_-]*$/.test(cssPrefix))) {
			console.error("d3pie error: invalid options.misc.cssPrefix");
			return false;
		}

		// confirm some data has been supplied
		if (!helpers.isArray(options.data.content)) {
			console.error("d3pie error: invalid config structure: missing data.content property.");
			return false;
		}
		if (options.data.content.length === 0) {
			console.error("d3pie error: no data supplied.");
			return false;
		}

		// clear out any invalid data. Each data row needs a valid positive number and a label
		var data = [];
		for (var i=0; i<options.data.content.length; i++) {
			if (typeof options.data.content[i].value !== "number" || isNaN(options.data.content[i].value)) {
				console.log("not valid: ", options.data.content[i]);
				continue;
			}
			if (options.data.content[i].value <= 0) {
				console.log("not valid - should have positive value: ", options.data.content[i]);
				continue;
			}
			data.push(options.data.content[i]);
		}
		pie.options.data.content = data;

		// labels.outer.hideWhenLessThanPercentage - 1-100
		// labels.inner.hideWhenLessThanPercentage - 1-100

		return true;
	}
};

	//// --------- helpers.js -----------
var helpers = {

	// creates the SVG element
	addSVGSpace: function(pie) {
		var element = pie.element;
		var canvasWidth = pie.options.size.canvasWidth;
		var canvasHeight = pie.options.size.canvasHeight;
		var backgroundColor = pie.options.misc.colors.background;

		var svg = d3.select(element).append("svg:svg")
			.attr("width", canvasWidth)
			.attr("viewBox", "0 0 "+ canvasWidth + " " + canvasHeight);

		if (backgroundColor !== "transparent") {
			svg.style("background-color", function() { return backgroundColor; });
		}

		var g = svg.append("g")
		    .attr("transform", "translate(" + canvasWidth / 2 + "," + canvasHeight / 2 + ")")
		    .attr("class", "image");
		
		var radius = 195;

		var shadowFilter = svg.append("defs")
			.append("filter")
				.attr("id", "shadow")
				.attr("x", "-5%")
				.attr("y", "-5%")
				.attr("width", "200%")
				.attr("height", "200%");
		shadowFilter.append("feOffset")
			.attr("result", "offOut")
			.attr("in", "SourceAlpha")
			.attr("dy", "2")
			.attr("dx", "2");
		shadowFilter.append("feGaussianBlur")
			.attr("result", "blurOut")
			.attr("in", "offOut")
			.attr("stdDeviation", "7");
		shadowFilter.append("feBlend")
			.attr("in", "SourceGraphic")
			.attr("in2", "blurOut")
			.attr("mode", "normal");



		var clip = g
		  .append("clipPath")
		    .attr("id", "circleclip")
		  .append("circle")
		    .attr("r", radius - 75)
		    .attr("cx", 0)
		    .attr("cy", 0);

		var shadow = g
		  .append("circle")
		    .attr("r", radius - 75)
		    .attr("cx", 0)
		    .attr("cy", 0)
		    .attr("opacity", 0.4)
		    .attr("class", "shadow")
		    .attr("filter", "url(#shadow)")
		console.log(pie);
		var image = g
		  .append("image")
		    .attr("xlink:href", "/assets/images/why-stash/activist.jpg")
		    .attr("width", 2* (radius -75))
		    .attr("height", 2 * (radius - 75))
		    .attr("x", -(radius -75))
		    .attr("y", -(radius -75))
		    .attr("clip-path", "url(#circleclip)");

		return svg;
	},

	whenIdExists: function(id, callback) {
		var inc = 1;
		var giveupIterationCount = 1000;

		var interval = setInterval(function() {
			if (document.getElementById(id)) {
				clearInterval(interval);
				callback();
			}
			if (inc > giveupIterationCount) {
				clearInterval(interval);
			}
			inc++;
		}, 1);
	},

	whenElementsExist: function(els, callback) {
		var inc = 1;
		var giveupIterationCount = 1000;

		var interval = setInterval(function() {
			var allExist = true;
			for (var i=0; i<els.length; i++) {
				if (!document.getElementById(els[i])) {
					allExist = false;
					break;
				}
			}
			if (allExist) {
				clearInterval(interval);
				callback();
			}
			if (inc > giveupIterationCount) {
				clearInterval(interval);
			}
			inc++;
		}, 1);
	},

	shuffleArray: function(array) {
		var currentIndex = array.length, tmpVal, randomIndex;

		while (0 !== currentIndex) {
			randomIndex = Math.floor(Math.random() * currentIndex);
			currentIndex -= 1;

			// and swap it with the current element
			tmpVal = array[currentIndex];
			array[currentIndex] = array[randomIndex];
			array[randomIndex] = tmpVal;
		}
		return array;
	},

	processObj: function(obj, is, value) {
		if (typeof is === 'string') {
			return helpers.processObj(obj, is.split('.'), value);
		} else if (is.length === 1 && value !== undefined) {
            obj[is[0]] = value;
			return obj[is[0]];
		} else if (is.length === 0) {
			return obj;
		} else {
			return helpers.processObj(obj[is[0]], is.slice(1), value);
		}
	},

	getDimensions: function(id) {
		var el = document.getElementById(id);
		var w = 0, h = 0;
		if (el) {
			var dimensions = el.getBBox();
			w = dimensions.width;
			h = dimensions.height;
		} else {
			console.log("error: getDimensions() " + id + " not found.");
		}
		return { w: w, h: h };
	},

	/**
	 * This is based on the SVG coordinate system, where top-left is 0,0 and bottom right is n-n.
	 * @param r1
	 * @param r2
	 * @returns {boolean}
	 */
	rectIntersect: function(r1, r2) {
		var returnVal = (
			// r2.left > r1.right
			(r2.x > (r1.x + r1.w)) ||

			// r2.right < r1.left
			((r2.x + r2.w) < r1.x) ||

			// r2.top < r1.bottom
			((r2.y + r2.h) < r1.y) ||

			// r2.bottom > r1.top
			(r2.y > (r1.y + r1.h))
		);

		return !returnVal;
	},

	/**
	 * Returns a lighter/darker shade of a hex value, based on a luminance value passed.
	 * @param hex a hex color value such as “#abc” or “#123456″ (the hash is optional)
	 * @param lum the luminosity factor: -0.1 is 10% darker, 0.2 is 20% lighter, etc.
	 * @returns {string}
	 */
	getColorShade: function(hex, lum) {

		// validate hex string
		hex = String(hex).replace(/[^0-9a-f]/gi, '');
		if (hex.length < 6) {
			hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];
		}
		lum = lum || 0;

		// convert to decimal and change luminosity
		var newHex = "#";
		for (var i=0; i<3; i++) {
			var c = parseInt(hex.substr(i * 2, 2), 16);
			c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);
			newHex += ("00" + c).substr(c.length);
		}

		return newHex;
	},

	/**
	 * Users can choose to specify segment colors in three ways (in order of precedence):
	 * 	1. include a "color" attribute for each row in data.content
	 * 	2. include a misc.colors.segments property which contains an array of hex codes
	 * 	3. specify nothing at all and rely on this lib provide some reasonable defaults
	 *
	 * This function sees what's included and populates this.options.colors with whatever's required
	 * for this pie chart.
	 * @param data
	 */
	initSegmentColors: function(pie) {
		var data   = pie.options.data.content;
		var colors = pie.options.misc.colors.segments;

		// TODO this needs a ton of error handling

		var finalColors = [];
		for (var i=0; i<data.length; i++) {
			if (data[i].hasOwnProperty("color")) {
				finalColors.push(data[i].color);
			} else {
				finalColors.push(colors[i]);
			}
		}

		return finalColors;
	},

	applySmallSegmentGrouping: function(data, smallSegmentGrouping) {
		var totalSize;
		if (smallSegmentGrouping.valueType === "percentage") {
			totalSize = math.getTotalPieSize(data);
		}

		// loop through each data item
		var newData = [];
		var groupedData = [];
		var totalGroupedData = 0;
		for (var i=0; i<data.length; i++) {
			if (smallSegmentGrouping.valueType === "percentage") {
				var dataPercent = (data[i].value / totalSize) * 100;
				if (dataPercent <= smallSegmentGrouping.value) {
					groupedData.push(data[i]);
					totalGroupedData += data[i].value;
					continue;
				}
				data[i].isGrouped = false;
				newData.push(data[i]);
			} else {
				if (data[i].value <= smallSegmentGrouping.value) {
					groupedData.push(data[i]);
					totalGroupedData += data[i].value;
					continue;
				}
				data[i].isGrouped = false;
				newData.push(data[i]);
			}
		}

		// we're done! See if there's any small segment groups to add
		if (groupedData.length) {
			newData.push({
				color: smallSegmentGrouping.color,
				label: smallSegmentGrouping.label,
				value: totalGroupedData,
				isGrouped: true,
				groupedData: groupedData
			});
		}

		return newData;
	},

	// for debugging
	showPoint: function(svg, x, y) {
		svg.append("circle").attr("cx", x).attr("cy", y).attr("r", 2).style("fill", "black");
	},

	isFunction: function(functionToCheck) {
		var getType = {};
		return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';
	},

	isArray: function(o) {
		return Object.prototype.toString.call(o) === '[object Array]';
	}
};


// taken from jQuery
var extend = function() {
	var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {},
		i = 1,
		length = arguments.length,
		deep = false,
		toString = Object.prototype.toString,
		hasOwn = Object.prototype.hasOwnProperty,
		class2type = {
			"[object Boolean]": "boolean",
			"[object Number]": "number",
			"[object String]": "string",
			"[object Function]": "function",
			"[object Array]": "array",
			"[object Date]": "date",
			"[object RegExp]": "regexp",
			"[object Object]": "object"
		},

		jQuery = {
			isFunction: function (obj) {
				return jQuery.type(obj) === "function";
			},
			isArray: Array.isArray ||
				function (obj) {
					return jQuery.type(obj) === "array";
				},
			isWindow: function (obj) {
				return obj !== null && obj === obj.window;
			},
			isNumeric: function (obj) {
				return !isNaN(parseFloat(obj)) && isFinite(obj);
			},
			type: function (obj) {
				return obj === null ? String(obj) : class2type[toString.call(obj)] || "object";
			},
			isPlainObject: function (obj) {
				if (!obj || jQuery.type(obj) !== "object" || obj.nodeType) {
					return false;
				}
				try {
					if (obj.constructor && !hasOwn.call(obj, "constructor") && !hasOwn.call(obj.constructor.prototype, "isPrototypeOf")) {
						return false;
					}
				} catch (e) {
					return false;
				}
				var key;
				for (key in obj) {}
				return key === undefined || hasOwn.call(obj, key);
			}
		};
	if (typeof target === "boolean") {
		deep = target;
		target = arguments[1] || {};
		i = 2;
	}
	if (typeof target !== "object" && !jQuery.isFunction(target)) {
		target = {};
	}
	if (length === i) {
		target = this;
		--i;
	}
	for (i; i < length; i++) {
		if ((options = arguments[i]) !== null) {
			for (name in options) {
				src = target[name];
				copy = options[name];
				if (target === copy) {
					continue;
				}
				if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {
					if (copyIsArray) {
						copyIsArray = false;
						clone = src && jQuery.isArray(src) ? src : [];
					} else {
						clone = src && jQuery.isPlainObject(src) ? src : {};
					}
					// WARNING: RECURSION
					target[name] = extend(deep, clone, copy);
				} else if (copy !== undefined) {
					target[name] = copy;
				}
			}
		}
	}
	return target;
};
	//// --------- math.js -----------
var math = {

	toRadians: function(degrees) {
		return degrees * (Math.PI / 180);
	},

	toDegrees: function(radians) {
		return radians * (180 / Math.PI);
	},

	computePieRadius: function(pie) {
		var size = pie.options.size;
		var canvasPadding = pie.options.misc.canvasPadding;

		// outer radius is either specified (e.g. through the generator), or omitted altogether
		// and calculated based on the canvas dimensions. Right now the estimated version isn't great - it should
		// be possible to calculate it to precisely generate the maximum sized pie, but it's fussy as heck. Something
		// for the next release.

		// first, calculate the default _outerRadius
		var w = size.canvasWidth - canvasPadding.left - canvasPadding.right;
		var h = size.canvasHeight - canvasPadding.top - canvasPadding.bottom;

		// now factor in the footer, title & subtitle
    if (pie.options.header.location !== "pie-center") {
      h -= pie.textComponents.headerHeight;
    }

    if (pie.textComponents.footer.exists) {
      h -= pie.textComponents.footer.h;
    }

		// for really teeny pies, h may be < 0. Adjust it back
		h = (h < 0) ? 0 : h;

		var outerRadius = ((w < h) ? w : h) / 3;
		var innerRadius, percent;

		// if the user specified something, use that instead
		if (size.pieOuterRadius !== null) {
			if (/%/.test(size.pieOuterRadius)) {
				percent = parseInt(size.pieOuterRadius.replace(/[\D]/, ""), 10);
				percent = (percent > 99) ? 99 : percent;
				percent = (percent < 0) ? 0 : percent;

				var smallestDimension = (w < h) ? w : h;

				// now factor in the label line size
				if (pie.options.labels.outer.format !== "none") {
					var pieDistanceSpace = parseInt(pie.options.labels.outer.pieDistance, 10) * 2;
					if (smallestDimension - pieDistanceSpace > 0) {
						smallestDimension -= pieDistanceSpace;
					}
				}

				outerRadius = Math.floor((smallestDimension / 100) * percent) / 2;
			} else {
				outerRadius = parseInt(size.pieOuterRadius, 10);
			}
		}

		// inner radius
		if (/%/.test(size.pieInnerRadius)) {
			percent = parseInt(size.pieInnerRadius.replace(/[\D]/, ""), 10);
			percent = (percent > 99) ? 99 : percent;
			percent = (percent < 0) ? 0 : percent;
			innerRadius = Math.floor((outerRadius / 100) * percent);
		} else {
			innerRadius = parseInt(size.pieInnerRadius, 10);
		}

		pie.innerRadius = innerRadius;
		pie.outerRadius = outerRadius;
	},

	getTotalPieSize: function(data) {
		var totalSize = 0;
		for (var i=0; i<data.length; i++) {
			totalSize += data[i].value;
		}
		return totalSize;
	},

	sortPieData: function(pie) {
		var data                 = pie.options.data.content;
		var sortOrder            = pie.options.data.sortOrder;

		switch (sortOrder) {
			case "none":
				// do nothing
				break;
			case "random":
				data = helpers.shuffleArray(data);
				break;
			case "value-asc":
				data.sort(function(a, b) { return (a.value < b.value) ? -1 : 1; });
				break;
			case "value-desc":
				data.sort(function(a, b) { return (a.value < b.value) ? 1 : -1; });
				break;
			case "label-asc":
				data.sort(function(a, b) { return (a.label.toLowerCase() > b.label.toLowerCase()) ? 1 : -1; });
				break;
			case "label-desc":
				data.sort(function(a, b) { return (a.label.toLowerCase() < b.label.toLowerCase()) ? 1 : -1; });
				break;
		}

		return data;
	},

	

	// var pieCenter = math.getPieCenter();
	getPieTranslateCenter: function(pieCenter) {
		return "translate(" + pieCenter.x + "," + pieCenter.y + ")";
	},

	/**
	 * Used to determine where on the canvas the center of the pie chart should be. It takes into account the
	 * height and position of the title, subtitle and footer, and the various paddings.
	 * @private
	 */
	calculatePieCenter: function(pie) {
		var pieCenterOffset = pie.options.misc.pieCenterOffset;
		var hasTopTitle    = (pie.textComponents.title.exists && pie.options.header.location !== "pie-center");
		var hasTopSubtitle = (pie.textComponents.subtitle.exists && pie.options.header.location !== "pie-center");

		var headerOffset = pie.options.misc.canvasPadding.top;
		if (hasTopTitle && hasTopSubtitle) {
			headerOffset += pie.textComponents.title.h + pie.options.header.titleSubtitlePadding + pie.textComponents.subtitle.h;
		} else if (hasTopTitle) {
			headerOffset += pie.textComponents.title.h;
		} else if (hasTopSubtitle) {
			headerOffset += pie.textComponents.subtitle.h;
		}

		var footerOffset = 0;
		if (pie.textComponents.footer.exists) {
			footerOffset = pie.textComponents.footer.h + pie.options.misc.canvasPadding.bottom;
		}

		var x = ((pie.options.size.canvasWidth - pie.options.misc.canvasPadding.left - pie.options.misc.canvasPadding.right) / 2) + pie.options.misc.canvasPadding.left;
		var y = ((pie.options.size.canvasHeight - footerOffset - headerOffset) / 2) + headerOffset;

		// x += pieCenterOffset.x;
		// y += pieCenterOffset.y;

		pie.pieCenter = { x: pie.options.size.canvasWidth / 2, y: pie.options.size.canvasHeight / 2 };
	},


	/**
	 * Rotates a point (x, y) around an axis (xm, ym) by degrees (a).
	 * @param x
	 * @param y
	 * @param xm
	 * @param ym
	 * @param a angle in degrees
	 * @returns {Array}
	 */
	rotate: function(x, y, xm, ym, a) {

        a = a * Math.PI / 180; // convert to radians

        var cos = Math.cos,
			sin = Math.sin,
		// subtract midpoints, so that midpoint is translated to origin and add it in the end again
		xr = (x - xm) * cos(a) - (y - ym) * sin(a) + xm,
		yr = (x - xm) * sin(a) + (y - ym) * cos(a) + ym;

		return { x: xr, y: yr };
	},

	/**
	 * Translates a point x, y by distance d, and by angle a.
	 * @param x
	 * @param y
	 * @param dist
	 * @param a angle in degrees
	 */
	translate: function(x, y, d, a) {
		var rads = math.toRadians(a);
		return {
			x: x + d * Math.sin(rads),
			y: y - d * Math.cos(rads)
		};
	},

	// from: http://stackoverflow.com/questions/19792552/d3-put-arc-labels-in-a-pie-chart-if-there-is-enough-space
	pointIsInArc: function(pt, ptData, d3Arc) {
		// Center of the arc is assumed to be 0,0
		// (pt.x, pt.y) are assumed to be relative to the center
		var r1 = d3Arc.innerRadius()(ptData), // Note: Using the innerRadius
			r2 = d3Arc.outerRadius()(ptData),
			theta1 = d3Arc.startAngle()(ptData),
			theta2 = d3Arc.endAngle()(ptData);

		var dist = pt.x * pt.x + pt.y * pt.y,
			angle = Math.atan2(pt.x, -pt.y); // Note: different coordinate system

		angle = (angle < 0) ? (angle + Math.PI * 2) : angle;

		return (r1 * r1 <= dist) && (dist <= r2 * r2) &&
			(theta1 <= angle) && (angle <= theta2);
	}
};

	//// --------- labels.js -----------
var labels = {

	/**
	 * Adds the labels to the pie chart, but doesn't position them. There are two locations for the
	 * labels: inside (center) of the segments, or outside the segments on the edge.
	 * @param section "inner" or "outer"
	 * @param sectionDisplayType "percentage", "value", "label", "label-value1", etc.
	 * @param pie
	 */
	add: function(pie, section, sectionDisplayType) {
		var include = labels.getIncludes(sectionDisplayType);
		var settings = pie.options.labels;

		// group the label groups (label, percentage, value) into a single element for simpler positioning
		var outerLabel = pie.svg.insert("g", "." + pie.cssPrefix + "labels-" + section)
			.attr("class", pie.cssPrefix + "labels-" + section);

		var labelGroup = outerLabel.selectAll("." + pie.cssPrefix + "labelGroup-" + section)
			.data(pie.options.data.content)
			.enter()
			.append("g")
			.attr("id", function(d, i) { return pie.cssPrefix + "labelGroup" + i + "-" + section; })
			.attr("data-index", function(d, i) { return i; })
			.attr("class", pie.cssPrefix + "labelGroup-" + section)
			.style("opacity", 0);

    var formatterContext = { section: section, sectionDisplayType: sectionDisplayType };

		// 1. Add the main label
		if (include.mainLabel) {
			labelGroup.append("text")
				.attr("id", function(d, i) { return pie.cssPrefix + "segmentMainLabel" + i + "-" + section; })
				.attr("class", pie.cssPrefix + "segmentMainLabel-" + section)
				.text(function(d, i) {
					var str = d.label;

          // if a custom formatter has been defined, pass it the raw label string - it can do whatever it wants with it.
          // we only apply truncation if it's not defined
					if (settings.formatter) {
            formatterContext.index = i;
            formatterContext.part = 'mainLabel';
            formatterContext.value = d.value;
            formatterContext.label = str;
            str = settings.formatter(formatterContext);
          } else if (settings.truncation.enabled && d.label.length > settings.truncation.truncateLength) {
            str = d.label.substring(0, settings.truncation.truncateLength) + "...";
          }
          return str;
				})
				.style("font-size", settings.mainLabel.fontSize + "px")
				.style("font-family", settings.mainLabel.font)
				.style("fill", settings.mainLabel.color);
		}

		// 2. Add the percentage label
		if (include.percentage) {
			labelGroup.append("text")
				.attr("id", function(d, i) { return pie.cssPrefix + "segmentPercentage" + i + "-" + section; })
				.attr("class", pie.cssPrefix + "segmentPercentage-" + section)
				.text(function(d, i) {
					var percentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);
          if (settings.formatter) {
            formatterContext.index = i;
            formatterContext.part = "percentage";
            formatterContext.value = d.value;
            formatterContext.label = percentage;
            percentage = settings.formatter(formatterContext);
          } else {
            percentage += "%";
          }
          return percentage;
				})
				.style("font-size", settings.percentage.fontSize + "px")
				.style("font-family", settings.percentage.font)
				.style("fill", settings.percentage.color);
		}

		// 3. Add the value label
		if (include.value) {
			labelGroup.append("text")
				.attr("id", function(d, i) { return pie.cssPrefix +  "segmentValue" + i + "-" + section; })
				.attr("class", pie.cssPrefix + "segmentValue-" + section)
				.text(function(d, i) {
          formatterContext.index = i;
          formatterContext.part = "value";
          formatterContext.value = d.value;
          formatterContext.label = d.value;
          return settings.formatter ? settings.formatter(formatterContext, d.value) : d.value;
        })
				.style("font-size", settings.value.fontSize + "px")
				.style("font-family", settings.value.font)
				.style("fill", settings.value.color);
		}
	},

	/**
	 * @param section "inner" / "outer"
	 */
	positionLabelElements: function(pie, section, sectionDisplayType) {
		labels["dimensions-" + section] = [];

		// get the latest widths, heights
		var labelGroups = d3.selectAll("." + pie.cssPrefix + "labelGroup-" + section);
		labelGroups.each(function(d, i) {
			var mainLabel  = d3.select(this).selectAll("." + pie.cssPrefix + "segmentMainLabel-" + section);
			var percentage = d3.select(this).selectAll("." + pie.cssPrefix + "segmentPercentage-" + section);
			var value      = d3.select(this).selectAll("." + pie.cssPrefix + "segmentValue-" + section);

			labels["dimensions-" + section].push({
				mainLabel:  (mainLabel.node() !== null) ? mainLabel.node().getBBox() : null,
				percentage: (percentage.node() !== null) ? percentage.node().getBBox() : null,
				value:      (value.node() !== null) ? value.node().getBBox() : null
			});
		});

		var singleLinePad = 5;
		var dims = labels["dimensions-" + section];
		switch (sectionDisplayType) {
			case "label-value1":
				d3.selectAll("." + pie.cssPrefix + "segmentValue-" + section)
					.attr("dx", function(d, i) { return dims[i].mainLabel.width + singleLinePad; });
				break;
			case "label-value2":
				d3.selectAll("." + pie.cssPrefix + "segmentValue-" + section)
					.attr("dy", function(d, i) { return dims[i].mainLabel.height; });
				break;
			case "label-percentage1":
				d3.selectAll("." + pie.cssPrefix + "segmentPercentage-" + section)
					.attr("dx", function(d, i) { return dims[i].mainLabel.width + singleLinePad; });
				break;
			case "label-percentage2":
				d3.selectAll("." + pie.cssPrefix + "segmentPercentage-" + section)
					.attr("dx", function(d, i) { return (dims[i].mainLabel.width / 2) - (dims[i].percentage.width / 2); })
					.attr("dy", function(d, i) { return dims[i].mainLabel.height; });
				break;
	 	}
	},

	computeLabelLinePositions: function(pie) {
		pie.lineCoordGroups = [];
		d3.selectAll("." + pie.cssPrefix + "labelGroup-outer")
			.each(function(d, i) { return labels.computeLinePosition(pie, i); });
	},

	computeLinePosition: function(pie, i) {
		var angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });
		var originCoords = math.rotate(pie.pieCenter.x, pie.pieCenter.y - pie.outerRadius, pie.pieCenter.x, pie.pieCenter.y, angle);
		var heightOffset = pie.outerLabelGroupData[i].h / 5; // TODO check
		var labelXMargin = 6; // the x-distance of the label from the end of the line [TODO configurable]

		var quarter = Math.floor(angle / 90);
		var midPoint = 4;
		var x2, y2, x3, y3;

		// this resolves an issue when the
		if (quarter === 2 && angle === 180) {
			quarter = 1;
		}

		switch (quarter) {
			case 0:
				x2 = pie.outerLabelGroupData[i].x - labelXMargin - ((pie.outerLabelGroupData[i].x - labelXMargin - originCoords.x) / 2);
				y2 = pie.outerLabelGroupData[i].y + ((originCoords.y - pie.outerLabelGroupData[i].y) / midPoint);
				x3 = pie.outerLabelGroupData[i].x - labelXMargin;
				y3 = pie.outerLabelGroupData[i].y - heightOffset;
				break;
			case 1:
				x2 = originCoords.x + (pie.outerLabelGroupData[i].x - originCoords.x) / midPoint;
				y2 = originCoords.y + (pie.outerLabelGroupData[i].y - originCoords.y) / midPoint;
				x3 = pie.outerLabelGroupData[i].x - labelXMargin;
				y3 = pie.outerLabelGroupData[i].y - heightOffset;
				break;
			case 2:
				var startOfLabelX = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;
				x2 = originCoords.x - (originCoords.x - startOfLabelX) / midPoint;
				y2 = originCoords.y + (pie.outerLabelGroupData[i].y - originCoords.y) / midPoint;
				x3 = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;
				y3 = pie.outerLabelGroupData[i].y - heightOffset;
				break;
			case 3:
				var startOfLabel = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;
				x2 = startOfLabel + ((originCoords.x - startOfLabel) / midPoint);
				y2 = pie.outerLabelGroupData[i].y + (originCoords.y - pie.outerLabelGroupData[i].y) / midPoint;
				x3 = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;
				y3 = pie.outerLabelGroupData[i].y - heightOffset;
				break;
		}

		/*
		 * x1 / y1: the x/y coords of the start of the line, at the mid point of the segments arc on the pie circumference
		 * x2 / y2: if "curved" line style is being used, this is the midpoint of the line. Other
		 * x3 / y3: the end of the line; closest point to the label
		 */
		if (pie.options.labels.lines.style === "straight") {
			pie.lineCoordGroups[i] = [
				{ x: originCoords.x, y: originCoords.y },
				{ x: x3, y: y3 }
			];
		} else {
			pie.lineCoordGroups[i] = [
				{ x: originCoords.x, y: originCoords.y },
				{ x: x2, y: y2 },
				{ x: x3, y: y3 }
			];
		}
	},

	addLabelLines: function(pie) {
		var lineGroups = pie.svg.insert("g", "." + pie.cssPrefix + "pieChart") // meaning, BEFORE .pieChart
			.attr("class", pie.cssPrefix + "lineGroups")
			.style("opacity", 0);

		var lineGroup = lineGroups.selectAll("." + pie.cssPrefix + "lineGroup")
			.data(pie.lineCoordGroups)
			.enter()
			.append("g")
			.attr("class", pie.cssPrefix + "lineGroup");

		var lineFunction = d3.svg.line()
			.interpolate("basis")
			.x(function(d) { return d.x; })
			.y(function(d) { return d.y; });

		lineGroup.append("path")
			.attr("d", lineFunction)
			.attr("stroke", function(d, i) {
				return (pie.options.labels.lines.color === "segment") ? pie.options.colors[i] : pie.options.labels.lines.color;
			})
			.attr("stroke-width", 0)
			.attr("fill", "none")
			.style("opacity", function(d, i) {
				var percentage = pie.options.labels.outer.hideWhenLessThanPercentage;
				var segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);
				var isHidden = (percentage !== null && segmentPercentage < percentage) || pie.options.data.content[i].label === "";
				return isHidden ? 0 : 1;
			});
	},

	positionLabelGroups: function(pie, section) {
    if (pie.options.labels[section].format === "none") {
      return;
    }

		d3.selectAll("." + pie.cssPrefix + "labelGroup-" + section)
			.style("opacity", 0)
			.attr("transform", function(d, i) {
				var x, y;
				if (section === "outer") {
					x = pie.outerLabelGroupData[i].x;
					y = pie.outerLabelGroupData[i].y;
				} else {
					var pieCenterCopy = extend(true, {}, pie.pieCenter);

					// now recompute the "center" based on the current _innerRadius
					if (pie.innerRadius > 0) {
						var angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });
						var newCoords = math.translate(pie.pieCenter.x, pie.pieCenter.y, pie.innerRadius, angle);
						pieCenterCopy.x = newCoords.x;
						pieCenterCopy.y = newCoords.y;
					}

					var dims = helpers.getDimensions(pie.cssPrefix + "labelGroup" + i + "-inner");
					var xOffset = dims.w / 2;
					var yOffset = dims.h / 4; // confusing! Why 4? should be 2, but it doesn't look right

					x = pieCenterCopy.x + (pie.lineCoordGroups[i][0].x - pieCenterCopy.x) / 1.8;
					y = pieCenterCopy.y + (pie.lineCoordGroups[i][0].y - pieCenterCopy.y) / 1.8;

					x = x - xOffset;
					y = y + yOffset;
				}

				return "translate(" + x + "," + y + ")";
			});
	},


	fadeInLabelsAndLines: function(pie) {

		// fade in the labels when the load effect is complete - or immediately if there's no load effect
		var loadSpeed = (pie.options.effects.load.effect === "default") ? pie.options.effects.load.speed : 1;
		setTimeout(function() {
			var labelFadeInTime = (pie.options.effects.load.effect === "default") ? 400 : 1; // 400 is hardcoded for the present

			d3.selectAll("." + pie.cssPrefix + "labelGroup-outer")
				.transition()
				.duration(labelFadeInTime)
				.style("opacity", function(d, i) {
					var percentage = pie.options.labels.outer.hideWhenLessThanPercentage;
					var segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);
					return (percentage !== null && segmentPercentage < percentage) ? 0 : 1;
				});

			d3.selectAll("." + pie.cssPrefix + "labelGroup-inner")
				.transition()
				.duration(labelFadeInTime)
				.style("opacity", function(d, i) {
					var percentage = pie.options.labels.inner.hideWhenLessThanPercentage;
					var segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);
					return (percentage !== null && segmentPercentage < percentage) ? 0 : 1;
				});

			d3.selectAll("g." + pie.cssPrefix + "lineGroups")
				.transition()
				.duration(labelFadeInTime)
				.style("opacity", 1);

			// once everything's done loading, trigger the onload callback if defined
			if (helpers.isFunction(pie.options.callbacks.onload)) {
				setTimeout(function() {
					try {
						pie.options.callbacks.onload();
					} catch (e) { }
				}, labelFadeInTime);
			}
		}, loadSpeed);
	},

	getIncludes: function(val) {
		var addMainLabel  = false;
		var addValue      = false;
		var addPercentage = false;

		switch (val) {
			case "label":
				addMainLabel = true;
				break;
			case "value":
				addValue = true;
				break;
			case "percentage":
				addPercentage = true;
				break;
			case "label-value1":
			case "label-value2":
				addMainLabel = true;
				addValue = true;
				break;
			case "label-percentage1":
			case "label-percentage2":
				addMainLabel = true;
				addPercentage = true;
				break;
		}
		return {
			mainLabel: addMainLabel,
			value: addValue,
			percentage: addPercentage
		};
	},


	/**
	 * This does the heavy-lifting to compute the actual coordinates for the outer label groups. It does two things:
	 * 1. Make a first pass and position them in the ideal positions, based on the pie sizes
	 * 2. Do some basic collision avoidance.
	 */
	computeOuterLabelCoords: function(pie) {

		// 1. figure out the ideal positions for the outer labels
		pie.svg.selectAll("." + pie.cssPrefix + "labelGroup-outer")
			.each(function(d, i) {
				return labels.getIdealOuterLabelPositions(pie, i);
			});

		// 2. now adjust those positions to try to accommodate conflicts
		labels.resolveOuterLabelCollisions(pie);
	},

	/**
	 * This attempts to resolve label positioning collisions.
	 */
	resolveOuterLabelCollisions: function(pie) {
    if (pie.options.labels.outer.format === "none") {
      return;
    }

		var size = pie.options.data.content.length;
		labels.checkConflict(pie, 0, "clockwise", size);
		labels.checkConflict(pie, size-1, "anticlockwise", size);
	},

	checkConflict: function(pie, currIndex, direction, size) {
    var i, curr;

		if (size <= 1) {
			return;
		}

		var currIndexHemisphere = pie.outerLabelGroupData[currIndex].hs;
		if (direction === "clockwise" && currIndexHemisphere !== "right") {
			return;
		}
		if (direction === "anticlockwise" && currIndexHemisphere !== "left") {
			return;
		}
		var nextIndex = (direction === "clockwise") ? currIndex+1 : currIndex-1;

		// this is the current label group being looked at. We KNOW it's positioned properly (the first item
		// is always correct)
		var currLabelGroup = pie.outerLabelGroupData[currIndex];

		// this one we don't know about. That's the one we're going to look at and move if necessary
		var examinedLabelGroup = pie.outerLabelGroupData[nextIndex];

		var info = {
			labelHeights: pie.outerLabelGroupData[0].h,
			center: pie.pieCenter,
			lineLength: (pie.outerRadius + pie.options.labels.outer.pieDistance),
			heightChange: pie.outerLabelGroupData[0].h + 1 // 1 = padding
		};

		// loop through *ALL* label groups examined so far to check for conflicts. This is because when they're
		// very tightly fitted, a later label group may still appear high up on the page
		if (direction === "clockwise") {
      i = 0;
			for (; i<=currIndex; i++) {
				curr = pie.outerLabelGroupData[i];

				// if there's a conflict with this label group, shift the label to be AFTER the last known
				// one that's been properly placed
				if (helpers.rectIntersect(curr, examinedLabelGroup)) {
					labels.adjustLabelPos(pie, nextIndex, currLabelGroup, info);
					break;
				}
			}
		} else {
      i = size - 1;
			for (; i >= currIndex; i--) {
				curr = pie.outerLabelGroupData[i];

				// if there's a conflict with this label group, shift the label to be AFTER the last known
				// one that's been properly placed
				if (helpers.rectIntersect(curr, examinedLabelGroup)) {
					labels.adjustLabelPos(pie, nextIndex, currLabelGroup, info);
					break;
				}
			}
		}
		labels.checkConflict(pie, nextIndex, direction, size);
	},

	// does a little math to shift a label into a new position based on the last properly placed one
	adjustLabelPos: function(pie, nextIndex, lastCorrectlyPositionedLabel, info) {
		var xDiff, yDiff, newXPos, newYPos;
		newYPos = lastCorrectlyPositionedLabel.y + info.heightChange;
		yDiff = info.center.y - newYPos;

		if (Math.abs(info.lineLength) > Math.abs(yDiff)) {
			xDiff = Math.sqrt((info.lineLength * info.lineLength) - (yDiff * yDiff));
		} else {
			xDiff = Math.sqrt((yDiff * yDiff) - (info.lineLength * info.lineLength));
		}

		if (lastCorrectlyPositionedLabel.hs === "right") {
			newXPos = info.center.x + xDiff;
		} else {
			newXPos = info.center.x - xDiff - pie.outerLabelGroupData[nextIndex].w;
		}

		pie.outerLabelGroupData[nextIndex].x = newXPos;
		pie.outerLabelGroupData[nextIndex].y = newYPos;
	},

	/**
	 * @param i 0-N where N is the dataset size - 1.
	 */
	getIdealOuterLabelPositions: function(pie, i) {
    var labelGroupNode = d3.select("#" + pie.cssPrefix + "labelGroup" + i + "-outer").node();
    if (!labelGroupNode) {
      return;
    }
    var labelGroupDims = labelGroupNode.getBBox();
		var angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });

		var originalX = pie.pieCenter.x;
		var originalY = pie.pieCenter.y - (pie.outerRadius + pie.options.labels.outer.pieDistance);
		var newCoords = math.rotate(originalX, originalY, pie.pieCenter.x, pie.pieCenter.y, angle);

		// if the label is on the left half of the pie, adjust the values
		var hemisphere = "right"; // hemisphere
		if (angle > 180) {
			newCoords.x -= (labelGroupDims.width + 8);
			hemisphere = "left";
		} else {
			newCoords.x += 8;
		}

		pie.outerLabelGroupData[i] = {
			x: newCoords.x,
			y: newCoords.y,
			w: labelGroupDims.width,
			h: labelGroupDims.height,
			hs: hemisphere
		};
	}
};

	//// --------- segments.js -----------
var segments = {

	/**
	 * Creates the pie chart segments and displays them according to the desired load effect.
	 * @private
	 */
	create: function(pie) {
		var pieCenter = pie.pieCenter;
		var colors = pie.options.colors;
		var loadEffects = pie.options.effects.load;
		var segmentStroke = pie.options.misc.colors.segmentStroke;

		// we insert the pie chart BEFORE the title, to ensure the title overlaps the pie
		var pieChartElement = pie.svg.insert("g", ".image")
			.attr("transform", function() { return math.getPieTranslateCenter(pieCenter); })
			.append("g")
			.attr("class", pie.cssPrefix + "pieChart");

		var arc = d3.svg.arc()
			.innerRadius(pie.innerRadius)
			.outerRadius(pie.outerRadius)
			.startAngle(0)
			.endAngle(function(d) {
				return (d.value / pie.totalSize) * 2 * Math.PI;
			});

		var g = pieChartElement.selectAll("." + pie.cssPrefix + "arc")
			.data(pie.options.data.content)
			.enter()
			.append("g")
			.attr("class", pie.cssPrefix + "arc");

		// if we're not fading in the pie, just set the load speed to 0
		var loadSpeed = loadEffects.speed;
		if (loadEffects.effect === "none") {
			loadSpeed = 0;
		}

		g.append("path")
			.attr("id", function(d, i) { return pie.cssPrefix + "segment" + i; })
			.attr("fill", function(d, i) {
				var color = colors[i];
				if (pie.options.misc.gradient.enabled) {
					color = "url(#" + pie.cssPrefix + "grad" + i + ")";
				}
				return color;
			})
			.style("stroke", segmentStroke)
			.style("stroke-width", 0)
			.transition()
			.ease("cubic-in-out")
			.duration(loadSpeed)
			.attr("data-index", function(d, i) { return i; })
			.attrTween("d", function(b) {
				var i = d3.interpolate({ value: 0 }, b);
				return function(t) {
					return pie.arc(i(t));
				};
			});

		pie.svg.selectAll("g." + pie.cssPrefix + "arc")
			.attr("transform",
			function(d, i) {
				var angle = 0;
				if (i > 0) {
					angle = segments.getSegmentAngle(i-1, pie.options.data.content, pie.totalSize);
				}
				return "rotate(" + angle + ")";
			}
		);
		pie.arc = arc;
	},

	addGradients: function(pie) {
		var grads = pie.svg.append("defs")
			.selectAll("radialGradient")
			.data(pie.options.data.content)
			.enter().append("radialGradient")
			.attr("gradientUnits", "userSpaceOnUse")
			.attr("cx", 0)
			.attr("cy", 0)
			.attr("r", "120%")
			.attr("id", function(d, i) { return pie.cssPrefix + "grad" + i; });

		grads.append("stop").attr("offset", "0%").style("stop-color", function(d, i) { return pie.options.colors[i]; });
		grads.append("stop").attr("offset", pie.options.misc.gradient.percentage + "%").style("stop-color", pie.options.misc.gradient.color);
	},

	addSegmentEventHandlers: function(pie) {
		var arc = d3.selectAll("." + pie.cssPrefix + "arc,." + pie.cssPrefix + "labelGroup-inner,." + pie.cssPrefix + "labelGroup-outer");

		arc.on("click", function() {
			var currentEl = d3.select(this);
			var segment;

			// mouseover works on both the segments AND the segment labels, hence the following
			if (currentEl.attr("class") === pie.cssPrefix + "arc") {
				segment = currentEl.select("path");
			} else {
				var index = currentEl.attr("data-index");
				segment = d3.select("#" + pie.cssPrefix + "segment" + index);
			}
			var isExpanded = segment.attr("class") === pie.cssPrefix + "expanded";
			segments.onSegmentEvent(pie, pie.options.callbacks.onClickSegment, segment, isExpanded);
			if (pie.options.effects.pullOutSegmentOnClick.effect !== "none") {
				if (isExpanded) {
					// segments.closeSegment(pie, segment.node());
				} else {
					segments.openSegment(pie, segment.node());
				}
			}
		});

		arc.on("mouseover", function() {
			var currentEl = d3.select(this);
			var segment, index;

			if (currentEl.attr("class") === pie.cssPrefix + "arc") {
				segment = currentEl.select("path");
			} else {
				index = currentEl.attr("data-index");
				segment = d3.select("#" + pie.cssPrefix + "segment" + index);
			}

			if (pie.options.effects.highlightSegmentOnMouseover) {
				index = segment.attr("data-index");
				var segColor = pie.options.colors[index];
				segment.style("fill", helpers.getColorShade(segColor, pie.options.effects.highlightLuminosity));
			}

      if (pie.options.tooltips.enabled) {
        index = segment.attr("data-index");
        tt.showTooltip(pie, index);
      }

			var isExpanded = segment.attr("class") === pie.cssPrefix + "expanded";
			segments.onSegmentEvent(pie, pie.options.callbacks.onMouseoverSegment, segment, isExpanded);
		});

    arc.on("mousemove", function() {
      tt.moveTooltip(pie);
    });

		arc.on("mouseout", function() {
			var currentEl = d3.select(this);
			var segment, index;

			if (currentEl.attr("class") === pie.cssPrefix + "arc") {
				segment = currentEl.select("path");
			} else {
				index = currentEl.attr("data-index");
				segment = d3.select("#" + pie.cssPrefix + "segment" + index);
			}

			if (pie.options.effects.highlightSegmentOnMouseover) {
				index = segment.attr("data-index");
				var color = pie.options.colors[index];
				if (pie.options.misc.gradient.enabled) {
					color = "url(#" + pie.cssPrefix + "grad" + index + ")";
				}
				segment.style("fill", color);
			}

      if (pie.options.tooltips.enabled) {
        index = segment.attr("data-index");
        tt.hideTooltip(pie, index);
      }

			var isExpanded = segment.attr("class") === pie.cssPrefix + "expanded";
			segments.onSegmentEvent(pie, pie.options.callbacks.onMouseoutSegment, segment, isExpanded);
		});
	},

	// helper function used to call the click, mouseover, mouseout segment callback functions
	onSegmentEvent: function(pie, func, segment, isExpanded) {
		if (!helpers.isFunction(func)) {
			return;
		}
		var index = parseInt(segment.attr("data-index"), 10);
		func({
			segment: segment.node(),
			index: index,
			expanded: isExpanded,
			data: pie.options.data.content[index]
		});
	},

	openSegment: function(pie, segment) {
		if (pie.isOpeningSegment) {
			return;
		}
		pie.isOpeningSegment = true;

		// close any open segments
		if (d3.selectAll("." + pie.cssPrefix + "expanded").length > 0) {
			segments.closeSegment(pie, d3.select("." + pie.cssPrefix + "expanded").node());
		}

		d3.select(segment).transition()
			.ease(pie.options.effects.pullOutSegmentOnClick.effect)
			.duration(pie.options.effects.pullOutSegmentOnClick.speed)
			.attr("d", function(d, i) {
				return d3.svg.arc()
				.innerRadius(pie.innerRadius)
				.outerRadius(pie.outerRadius+25)
				.startAngle(0)
				.endAngle(function(data) {
					return (d.value / pie.totalSize) * 2 * Math.PI;
				})();
				// var c = pie.arc.centroid(d),
				// 	x = c[0],
				// 	y = c[1],
				// 	h = Math.sqrt(x*x + y*y),
				// 	pullOutSize = parseInt(pie.options.effects.pullOutSegmentOnClick.size, 10);
				// return "scale(1.3) translate(" + ((x/h) * -pullOutSize) + ',' + ((y/h) * -pullOutSize) + ")"
				// return "translate(" + ((x/h) * pullOutSize) + ',' + ((y/h) * pullOutSize) + ")";
			})
			.each("end", function(d, i) {
				pie.currentlyOpenSegment = segment;
				pie.isOpeningSegment = false;
				d3.select(this).attr("class", pie.cssPrefix + "expanded");
			});
	},

	closeSegment: function(pie, segment) {
		d3.select(segment).transition()
			.duration(400)
			.attr("d", function(d, i) {
				return d3.svg.arc()
				.innerRadius(pie.innerRadius)
				.outerRadius(pie.outerRadius)
				.startAngle(0)
				.endAngle(function(data) {
					return (d.value / pie.totalSize) * 2 * Math.PI;
				})();
			})
			.each("end", function(d, i) {
				d3.select(this).attr("class", "");
				pie.currentlyOpenSegment = null;
			});
	},

	getCentroid: function(el) {
		var bbox = el.getBBox();
		return {
			x: bbox.x + bbox.width / 2,
			y: bbox.y + bbox.height / 2
		};
	},

	/**
	 * General helper function to return a segment's angle, in various different ways.
	 * @param index
	 * @param opts optional object for fine-tuning exactly what you want.
	 */
	getSegmentAngle: function(index, data, totalSize, opts) {
		var options = extend({
			// if true, this returns the full angle from the origin. Otherwise it returns the single segment angle
			compounded: true,

			// optionally returns the midpoint of the angle instead of the full angle
			midpoint: false
		}, opts);

		var currValue = data[index].value;
		var fullValue;
		if (options.compounded) {
			fullValue = 0;

			// get all values up to and including the specified index
			for (var i=0; i<=index; i++) {
				fullValue += data[i].value;
			}
		}

		if (typeof fullValue === 'undefined') {
			fullValue = currValue;
		}

		// now convert the full value to an angle
		var angle = (fullValue / totalSize) * 360;

		// lastly, if we want the midpoint, factor that sucker in
		if (options.midpoint) {
			var currAngle = (currValue / totalSize) * 360;
			angle -= (currAngle / 2);
		}

		return angle;
	},

	getPercentage: function(pie, index, decimalPlaces) {
		var relativeAmount = pie.options.data.content[index].value / pie.totalSize;
		if (decimalPlaces <= 0) {
			return Math.round(relativeAmount * 100);
		} else {
			return (relativeAmount * 100).toFixed(decimalPlaces);
		}
	}

};

	//// --------- text.js -----------
var text = {
	offscreenCoord: -10000,

	addTitle: function(pie) {
		var title = pie.svg.selectAll("." + pie.cssPrefix + "title")
			.data([pie.options.header.title])
			.enter()
			.append("text")
			.text(function(d) { return d.text; })
			.attr({
        id: pie.cssPrefix + "title",
        class: pie.cssPrefix + "title",
        x: text.offscreenCoord,
        y: text.offscreenCoord
      })
			.attr("text-anchor", function() {
				var location;
				if (pie.options.header.location === "top-center" || pie.options.header.location === "pie-center") {
					location = "middle";
				} else {
					location = "left";
				}
				return location;
			})
			.attr("fill", function(d) { return d.color; })
			.style("font-size", function(d) { return d.fontSize + "px"; })
			.style("font-family", function(d) { return d.font; });
	},

	positionTitle: function(pie) {
		var textComponents = pie.textComponents;
		var headerLocation = pie.options.header.location;
		var canvasPadding = pie.options.misc.canvasPadding;
		var canvasWidth = pie.options.size.canvasWidth;
		var titleSubtitlePadding = pie.options.header.titleSubtitlePadding;

		var x;
		if (headerLocation === "top-left") {
			x = canvasPadding.left;
		} else {
			x = ((canvasWidth - canvasPadding.right) / 2) + canvasPadding.left;
		}

    // add whatever offset has been added by user
    x += pie.options.misc.pieCenterOffset.x;

		var y = canvasPadding.top + textComponents.title.h;

		if (headerLocation === "pie-center") {
			y = pie.pieCenter.y;

			// still not fully correct
			if (textComponents.subtitle.exists) {
				var totalTitleHeight = textComponents.title.h + titleSubtitlePadding + textComponents.subtitle.h;
				y = y - (totalTitleHeight / 2) + textComponents.title.h;
			} else {
				y += (textComponents.title.h / 4);
			}
		}

		pie.svg.select("#" + pie.cssPrefix + "title")
			.attr("x", x)
			.attr("y", y);
	},

	addSubtitle: function(pie) {
		var headerLocation = pie.options.header.location;

		pie.svg.selectAll("." + pie.cssPrefix + "subtitle")
			.data([pie.options.header.subtitle])
			.enter()
			.append("text")
			.text(function(d) { return d.text; })
			.attr("x", text.offscreenCoord)
			.attr("y", text.offscreenCoord)
			.attr("id", pie.cssPrefix + "subtitle")
			.attr("class", pie.cssPrefix + "subtitle")
			.attr("text-anchor", function() {
				var location;
				if (headerLocation === "top-center" || headerLocation === "pie-center") {
					location = "middle";
				} else {
					location = "left";
				}
				return location;
			})
			.attr("fill", function(d) { return d.color; })
			.style("font-size", function(d) { return d.fontSize + "px"; })
			.style("font-family", function(d) { return d.font; });
	},

	positionSubtitle: function(pie) {
		var canvasPadding = pie.options.misc.canvasPadding;
		var canvasWidth = pie.options.size.canvasWidth;

		var x;
		if (pie.options.header.location === "top-left") {
			x = canvasPadding.left;
		} else {
			x = ((canvasWidth - canvasPadding.right) / 2) + canvasPadding.left;
		}

    // add whatever offset has been added by user
    x += pie.options.misc.pieCenterOffset.x;

		var y = text.getHeaderHeight(pie);
		pie.svg.select("#" + pie.cssPrefix + "subtitle")
			.attr("x", x)
			.attr("y", y);
	},

	addFooter: function(pie) {
		pie.svg.selectAll("." + pie.cssPrefix + "footer")
			.data([pie.options.footer])
			.enter()
			.append("text")
			.text(function(d) { return d.text; })
			.attr("x", text.offscreenCoord)
			.attr("y", text.offscreenCoord)
			.attr("id", pie.cssPrefix + "footer")
			.attr("class", pie.cssPrefix + "footer")
			.attr("text-anchor", function() {
				var location = "left";
				if (pie.options.footer.location === "bottom-center") {
					location = "middle";
				} else if (pie.options.footer.location === "bottom-right") {
					location = "left"; // on purpose. We have to change the x-coord to make it properly right-aligned
				}
				return location;
			})
			.attr("fill", function(d) { return d.color; })
			.style("font-size", function(d) { return d.fontSize + "px"; })
			.style("font-family", function(d) { return d.font; });
	},

	positionFooter: function(pie) {
		var footerLocation = pie.options.footer.location;
		var footerWidth = pie.textComponents.footer.w;
		var canvasWidth = pie.options.size.canvasWidth;
		var canvasHeight = pie.options.size.canvasHeight;
		var canvasPadding = pie.options.misc.canvasPadding;

		var x;
		if (footerLocation === "bottom-left") {
			x = canvasPadding.left;
		} else if (footerLocation === "bottom-right") {
			x = canvasWidth - footerWidth - canvasPadding.right;
		} else {
			x = canvasWidth / 2; // TODO - shouldn't this also take into account padding?
		}

		pie.svg.select("#" + pie.cssPrefix + "footer")
			.attr("x", x)
			.attr("y", canvasHeight - canvasPadding.bottom);
	},

	getHeaderHeight: function(pie) {
		var h;
		if (pie.textComponents.title.exists) {

			// if the subtitle isn't defined, it'll be set to 0
			var totalTitleHeight = pie.textComponents.title.h + pie.options.header.titleSubtitlePadding + pie.textComponents.subtitle.h;
			if (pie.options.header.location === "pie-center") {
				h = pie.pieCenter.y - (totalTitleHeight / 2) + totalTitleHeight;
			} else {
				h = totalTitleHeight + pie.options.misc.canvasPadding.top;
			}
		} else {
			if (pie.options.header.location === "pie-center") {
				var footerPlusPadding = pie.options.misc.canvasPadding.bottom + pie.textComponents.footer.h;
				h = ((pie.options.size.canvasHeight - footerPlusPadding) / 2) + pie.options.misc.canvasPadding.top + (pie.textComponents.subtitle.h / 2);
			} else {
				h = pie.options.misc.canvasPadding.top + pie.textComponents.subtitle.h;
			}
		}
		return h;
	}
};

  //// --------- validate.js -----------
var tt = {
	addTooltips: function(pie) {

		// group the label groups (label, percentage, value) into a single element for simpler positioning
		var tooltips = pie.svg.insert("g")
			.attr("class", pie.cssPrefix + "tooltips");

    tooltips.selectAll("." + pie.cssPrefix + "tooltip")
      .data(pie.options.data.content)
      .enter()
      .append("g")
        .attr("class", pie.cssPrefix + "tooltip")
        .attr("id", function(d, i) { return pie.cssPrefix + "tooltip" + i; })
        .style("opacity", 0)
      .append("rect")
        .attr({
			    rx: pie.options.tooltips.styles.borderRadius,
			    ry: pie.options.tooltips.styles.borderRadius,
			    x: -pie.options.tooltips.styles.padding,
			    opacity: pie.options.tooltips.styles.backgroundOpacity
		    })
		    .style("fill", pie.options.tooltips.styles.backgroundColor);

    tooltips.selectAll("." + pie.cssPrefix + "tooltip")
      .data(pie.options.data.content)
      .append("text")
        .attr("fill", function(d) { return pie.options.tooltips.styles.color; })
        .style("font-size", function(d) { return pie.options.tooltips.styles.fontSize; })
        .style("font-family", function(d) { return pie.options.tooltips.styles.font; })
        .text(function(d, i) {
          var caption = pie.options.tooltips.string;
          if (pie.options.tooltips.type === "caption") {
            caption = d.caption;
          }
          return tt.replacePlaceholders(pie, caption, i, {
            label: d.label,
            value: d.value,
            percentage: segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces)
          });
        });

		tooltips.selectAll("." + pie.cssPrefix + "tooltip rect")
			.attr({
				width: function (d, i) {
					var dims = helpers.getDimensions(pie.cssPrefix + "tooltip" + i);
					return dims.w + (2 * pie.options.tooltips.styles.padding);
				},
				height: function (d, i) {
					var dims = helpers.getDimensions(pie.cssPrefix + "tooltip" + i);
					return dims.h + (2 * pie.options.tooltips.styles.padding);
				},
				y: function (d, i) {
					var dims = helpers.getDimensions(pie.cssPrefix + "tooltip" + i);
					return -(dims.h / 2) + 1;
				}
			});
	},

  showTooltip: function(pie, index) {

	  var fadeInSpeed = pie.options.tooltips.styles.fadeInSpeed;
	  if (tt.currentTooltip === index) {
		  fadeInSpeed = 1;
	  }

    tt.currentTooltip = index;
    d3.select("#" + pie.cssPrefix + "tooltip" + index)
      .transition()
      .duration(fadeInSpeed)
      .style("opacity", function() { return 1; });

    tt.moveTooltip(pie);
  },

  moveTooltip: function(pie) {
    d3.selectAll("#" + pie.cssPrefix + "tooltip" + tt.currentTooltip)
      .attr("transform", function(d) {
        var mouseCoords = d3.mouse(this.parentNode);
        var x = mouseCoords[0] + pie.options.tooltips.styles.padding + 2;
        var y = mouseCoords[1] - (2 * pie.options.tooltips.styles.padding) - 2;
        return "translate(" + x + "," + y + ")";
      });
  },

  hideTooltip: function(pie, index) {
    d3.select("#" + pie.cssPrefix + "tooltip" + index)
      .style("opacity", function() { return 0; });

    // move the tooltip offscreen. This ensures that when the user next mouseovers the segment the hidden
    // element won't interfere
    d3.select("#" + pie.cssPrefix + "tooltip" + tt.currentTooltip)
       .attr("transform", function(d, i) {

         // klutzy, but it accounts for tooltip padding which could push it onscreen
         var x = pie.options.size.canvasWidth + 1000;
         var y = pie.options.size.canvasHeight + 1000;
         return "translate(" + x + "," + y + ")";
       });
  },

  replacePlaceholders: function(pie, str, index, replacements) {

    // if the user has defined a placeholderParser function, call it before doing the replacements
    if (helpers.isFunction(pie.options.tooltips.placeholderParser)) {
      pie.options.tooltips.placeholderParser(index, replacements);
    }

    var replacer = function()  {
      return function(match) {
        var placeholder = arguments[1];
        if (replacements.hasOwnProperty(placeholder)) {
          return replacements[arguments[1]];
        } else {
          return arguments[0];
        }
      };
    };
    return str.replace(/\{(\w+)\}/g, replacer(replacements));
  }
};


	// --------------------------------------------------------------------------------------------

	// our constructor
	var d3pie = function(element, options) {

		// element can be an ID or DOM element
		this.element = element;
		if (typeof element === "string") {
			var el = element.replace(/^#/, ""); // replace any jQuery-like ID hash char
			this.element = document.getElementById(el);
		}

		var opts = {};
		extend(true, opts, defaultSettings, options);
		this.options = opts;

		// if the user specified a custom CSS element prefix (ID, class), use it
		if (this.options.misc.cssPrefix !== null) {
			this.cssPrefix = this.options.misc.cssPrefix;
		} else {
			this.cssPrefix = "p" + _uniqueIDCounter + "_";
			_uniqueIDCounter++;
		}


		// now run some validation on the user-defined info
		if (!validate.initialCheck(this)) {
			return;
		}

		// add a data-role to the DOM node to let anyone know that it contains a d3pie instance, and the d3pie version
		d3.select(this.element).attr(_scriptName, _version);

		// things that are done once
		this.options.data.content = math.sortPieData(this);
		if (this.options.data.smallSegmentGrouping.enabled) {
			this.options.data.content = helpers.applySmallSegmentGrouping(this.options.data.content, this.options.data.smallSegmentGrouping);
		}
		this.options.colors = helpers.initSegmentColors(this);
		this.totalSize      = math.getTotalPieSize(this.options.data.content);

		_init.call(this);
	};

	d3pie.prototype.recreate = function() {
		// now run some validation on the user-defined info
		if (!validate.initialCheck(this)) {
			return;
		}
		this.options.data.content = math.sortPieData(this);
		if (this.options.data.smallSegmentGrouping.enabled) {
			this.options.data.content = helpers.applySmallSegmentGrouping(this.options.data.content, this.options.data.smallSegmentGrouping);
		}
		this.options.colors = helpers.initSegmentColors(this);
		this.totalSize      = math.getTotalPieSize(this.options.data.content);

		_init.call(this);
	};

	d3pie.prototype.redraw = function() {
		this.element.innerHTML = "";
		_init.call(this);
	};

	d3pie.prototype.destroy = function() {
		this.element.innerHTML = ""; // clear out the SVG
		d3.select(this.element).attr(_scriptName, null); // remove the data attr
	};

	/**
	 * Returns all pertinent info about the current open info. Returns null if nothing's open, or if one is, an object of
	 * the following form:
	 * 	{
	 * 	  element: DOM NODE,
	 * 	  index: N,
	 * 	  data: {}
	 * 	}
	 */
	d3pie.prototype.getOpenSegment = function() {
		var segment = this.currentlyOpenSegment;
		if (segment !== null && typeof segment !== "undefined") {
			var index = parseInt(d3.select(segment).attr("data-index"), 10);
			return {
				element: segment,
				index: index,
				data: this.options.data.content[index]
			};
		} else {
			return null;
		}
	};

	d3pie.prototype.openSegment = function(index) {
		index = parseInt(index, 10);
		if (index < 0 || index > this.options.data.content.length-1) {
			return;
		}
		segments.openSegment(this, d3.select("#" + this.cssPrefix + "segment" + index).node());
	};

	d3pie.prototype.closeSegment = function() {
		var segment = this.currentlyOpenSegment;
		if (segment) {
			segments.closeSegment(this, segment);
		}
	};

	// this let's the user dynamically update aspects of the pie chart without causing a complete redraw. It
	// intelligently re-renders only the part of the pie that the user specifies. Some things cause a repaint, others
	// just redraw the single element
	d3pie.prototype.updateProp = function(propKey, value) {
		switch (propKey) {
			case "header.title.text":
				var oldVal = helpers.processObj(this.options, propKey);
				helpers.processObj(this.options, propKey, value);
				d3.select("#" + this.cssPrefix + "title").html(value);
				if ((oldVal === "" && value !== "") || (oldVal !== "" && value === "")) {
					this.redraw();
				}
				break;

			case "header.subtitle.text":
				var oldValue = helpers.processObj(this.options, propKey);
				helpers.processObj(this.options, propKey, value);
				d3.select("#" + this.cssPrefix + "subtitle").html(value);
				if ((oldValue === "" && value !== "") || (oldValue !== "" && value === "")) {
					this.redraw();
				}
				break;

			case "callbacks.onload":
			case "callbacks.onMouseoverSegment":
			case "callbacks.onMouseoutSegment":
			case "callbacks.onClickSegment":
			case "effects.pullOutSegmentOnClick.effect":
			case "effects.pullOutSegmentOnClick.speed":
			case "effects.pullOutSegmentOnClick.size":
			case "effects.highlightSegmentOnMouseover":
			case "effects.highlightLuminosity":
				helpers.processObj(this.options, propKey, value);
				break;

			// everything else, attempt to update it & do a repaint
			default:
				helpers.processObj(this.options, propKey, value);

				this.destroy();
				this.recreate();
				break;
		}
	};


	// ------------------------------------------------------------------------------------------------


	var _init = function() {

		// prep-work
		this.svg = helpers.addSVGSpace(this);

		// store info about the main text components as part of the d3pie object instance
		this.textComponents = {
			headerHeight: 0,
			title: {
				exists: this.options.header.title.text !== "",
				h: 0,
				w: 0
			},
			subtitle: {
				exists: this.options.header.subtitle.text !== "",
				h: 0,
				w: 0
			},
			footer: {
				exists: this.options.footer.text !== "",
				h: 0,
				w: 0
			}
		};

		this.outerLabelGroupData = [];

		// add the key text components offscreen (title, subtitle, footer). We need to know their widths/heights for later computation
		if (this.textComponents.title.exists) {
			text.addTitle(this);
		}
		if (this.textComponents.subtitle.exists) {
			text.addSubtitle(this);
		}
		text.addFooter(this);

		// the footer never moves. Put it in place now
		var self = this;
		helpers.whenIdExists(this.cssPrefix + "footer", function() {
			text.positionFooter(self);
			var d3 = helpers.getDimensions(self.cssPrefix + "footer");
			self.textComponents.footer.h = d3.h;
			self.textComponents.footer.w = d3.w;
		});

		// now create the pie chart and position everything accordingly
		var reqEls = [];
		if (this.textComponents.title.exists)    { reqEls.push(this.cssPrefix + "title"); }
		if (this.textComponents.subtitle.exists) { reqEls.push(this.cssPrefix + "subtitle"); }
		if (this.textComponents.footer.exists)   { reqEls.push(this.cssPrefix + "footer"); }

		helpers.whenElementsExist(reqEls, function() {
			if (self.textComponents.title.exists) {
				var d1 = helpers.getDimensions(self.cssPrefix + "title");
				self.textComponents.title.h = d1.h;
				self.textComponents.title.w = d1.w;
			}
			if (self.textComponents.subtitle.exists) {
				var d2 = helpers.getDimensions(self.cssPrefix + "subtitle");
				self.textComponents.subtitle.h = d2.h;
				self.textComponents.subtitle.w = d2.w;
			}
			// now compute the full header height
			if (self.textComponents.title.exists || self.textComponents.subtitle.exists) {
				var headerHeight = 0;
				if (self.textComponents.title.exists) {
					headerHeight += self.textComponents.title.h;
					if (self.textComponents.subtitle.exists) {
						headerHeight += self.options.header.titleSubtitlePadding;
					}
				}
				if (self.textComponents.subtitle.exists) {
					headerHeight += self.textComponents.subtitle.h;
				}
				self.textComponents.headerHeight = headerHeight;
			}

			// at this point, all main text component dimensions have been calculated
			math.computePieRadius(self);

			// this value is used all over the place for placing things and calculating locations. We figure it out ONCE
			// and store it as part of the object
			math.calculatePieCenter(self);

			// position the title and subtitle
			text.positionTitle(self);
			text.positionSubtitle(self);

			// now create the pie chart segments, and gradients if the user desired
			if (self.options.misc.gradient.enabled) {
				segments.addGradients(self);
			}
			segments.create(self); // also creates this.arc
			labels.add(self, "inner", self.options.labels.inner.format);
			labels.add(self, "outer", self.options.labels.outer.format);

			// position the label elements relatively within their individual group (label, percentage, value)
			labels.positionLabelElements(self, "inner", self.options.labels.inner.format);
			labels.positionLabelElements(self, "outer", self.options.labels.outer.format);
			labels.computeOuterLabelCoords(self);

			// this is (and should be) dumb. It just places the outer groups at their calculated, collision-free positions
			labels.positionLabelGroups(self, "outer");

			// we use the label line positions for many other calculations, so ALWAYS compute them
			labels.computeLabelLinePositions(self);

			// only add them if they're actually enabled
			if (self.options.labels.lines.enabled && self.options.labels.outer.format !== "none") {
				labels.addLabelLines(self);
			}

			labels.positionLabelGroups(self, "inner");
			labels.fadeInLabelsAndLines(self);

      // add and position the tooltips
      if (self.options.tooltips.enabled) {
        tt.addTooltips(self);
      }

      segments.addSegmentEventHandlers(self);
		});
	};

  return d3pie;
}));</script><section class="portfolios" id="portfolios"><div class="wrap"><div class="intro"><h2>Portfolios as unique as you.</h2><p>It’s your money. Why not invest it in the things you love and believe in? Choose from a selection of <a class="tip" data-tip="A basket of investments (for example: stocks and bonds) bundled into a fund that is traded on an exchange. That fund owns the underlying assets (i.e. stocks, bonds, or even physical gold bars! #ScroogeMcDuck) and tracks an index - or group of companies with something in common.">ETFs</a>, conveniently named so you can cut through the finance jargon and get to the heart of what each investment stands for. Need some inspiration? Explore some options for customizing your portfolio.</p></div><div class="investor activist"><div class="icon-wrap"><div class="icon"></div></div><h3>The Activist</h3><div class="investments"><figure id="pie-activist"></figure><div class="investment"><p class="investment-header">Investment</p><p class="investment-name">Moderate Mix</p><p class="investment-description">Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for a moderate investor.</p><p class="investment-header">Sample <a class="tip" data-tip="The investments that are held by you. If your investment portfolio were a shopping bag, what would it be holding? 🛍️ Funds like ETFs have holdings, too.">Holdings</a></p><p class="investment-exposures">Total Bond ETF, S&amp;P 500 ETF, US Treasury Bond ETF</p></div></div></div><div class="investor techie"><div class="icon-wrap"><div class="icon"></div></div><h3>The Techie</h3><div class="investments"><div class="investment"><p class="investment-header">Investment</p><p class="investment-name">Roll with Buffett</p><p class="investment-description">Follow the leader. You can own a piece of Warren Buffett’s company -- he’s one of the most successful investors of all time.</p><p class="investment-header">Sample <a class="tip" data-tip="The investments that are held by you. If your investment portfolio were a shopping bag, what would it be holding? 🛍️ Funds like ETFs have holdings, too.">Holdings</a></p><p class="investment-exposures">Berkshire Hathaway Inc. Class B</p></div><figure id="pie-techie"></figure></div></div><div class="investor globetrotter"><div class="icon-wrap"><div class="icon"></div></div><h3>The Globetrotter</h3><div class="investments"><figure id="pie-globetrotter"></figure><div class="investment"><p class="investment-header">Investment</p><p class="investment-name">Global Citizen</p><p class="investment-description">Travel the globe. This ETF includes companies from over 40 countries covering all corners of the earth.</p><p class="investment-header">Sample <a class="tip" data-tip="The investments that are held by you. If your investment portfolio were a shopping bag, what would it be holding? 🛍️ Funds like ETFs have holdings, too.">Holdings</a></p><p class="investment-exposures">Johnson &amp; Johnson, Wells Fargo &amp; Co, Nestle SA, Tencent Holdings Ltd, Toyota Motor Corp.</p></div></div></div><div class="investor trendsetter"><div class="icon-wrap"><div class="icon"></div></div><h3>The Trendsetter</h3><div class="investments"><div class="investment"><p class="investment-header">Investment</p><p class="investment-name">Moderate Mix</p><p class="investment-description">Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for a moderate investor.</p><p class="investment-header">Sample <a class="tip" data-tip="The investments that are held by you. If your investment portfolio were a shopping bag, what would it be holding? 🛍️ Funds like ETFs have holdings, too.">Holdings</a></p><p class="investment-exposures">Total Bond ETF, S&amp;P 500 ETF, US Treasury Bond ETF</p></div><figure id="pie-trendsetter"></figure></div></div></div></section><section class="center cta"><div class="wrap"><!--h3 Start investing today--><!--a.get-stash.btn(href="https://app.stashinvest.com/sign-up") Get Stash--><h3>Learn more about our mission</h3><a class="btn" href="https://www.stashinvest.com/about-us">About us</a></div></section><script>var pieData = [{"name":"The Activist","className":"activist","pieId":"pie-activist","image":"/assets/images/why-stash/activist-circle.jpg","pie":[{"label":"Moderate Mix","description":"Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for a moderate investor.","value":60,"color":"#5348aa","exposures":["Total Bond ETF","S&P 500 ETF","US Treasury Bond ETF"]},{"label":"Clean & Green","description":"Create a bright future for our planet. This investment includes companies that produce solar, wind, and other forms of renewable energy.","value":14,"color":"#9690ca","exposures":["Electric Power Development Co","Meridian Energy LTD","Xinyi Solar Holdings Ltd","Vestas Wind Systems"]},{"label":"Do The Right Thing","description":"Do well by doing good. This ETF includes companies that focus on more than just the bottom line. They lead the way in sustainability, workplace equality, and community engagement.","value":15,"color":"#7883c9","exposures":["3M Co","Apple Inc","Ecolab Inc","Walt Disney","Kellogg","General Mills Inc"]},{"label":"Equality Works","description":"Champion equality for all. This is an investment in companies that support their lesbian, gay, bisexual and transgender employees with equal rights, inclusive policies, and respect.","value":15,"color":"#bebee3","exposures":["Yahoo! Inc","Yelp Inc","Netflix Inc","CEB Inc","Tesla Motors Inc"]}]},{"name":"The Techie","className":"techie","pieId":"pie-techie","image":"/assets/images/why-stash/techie-circle.jpg","pie":[{"label":"Roll with Buffett","description":"Follow the leader. You can own a piece of Warren Buffett’s company -- he’s one of the most successful investors of all time.","value":30,"color":"#6695cc","exposures":["Berkshire Hathaway Inc. Class B"]},{"label":"Aggressive Mix","description":"Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for an aggressive investor.","value":50,"color":"#c1d6ea","exposures":["Total Bond ETF, S&P 500 ETF, US Treasury Bond ETF"]},{"label":"American Innovators","description":"Change the world. This investment includes tech companies that take the stuff of imagination and make it reality.","value":19,"color":"#8aafd8","exposures":["Apple Inc, Facebook Inc, Microsoft Inc, Google Inc, Cisco Systems Inc"]},{"label":"Wireless Wonders","description":"Create strong connections. This ETF includes companies that build and maintain what we need to live in an interconnected world.","value":20,"color":"#4b88c4","exposures":["AT&T Inc, Verizon Communications Inc, T-Mobile Inc, Sprint Corp, Vonage Holdings Corp."]}]},{"name":"The Globetrotter","className":"globetrotter","pieId":"pie-globetrotter","image":"/assets/images/why-stash/globetrotter-circle.jpg","pie":[{"label":"Global Citizen","description":"Travel the globe. This ETF includes companies from over 40 countries covering all corners of the earth.","value":15,"color":"#e5e5e5","exposures":["Johnson & Johnson, Wells Fargo & Co, Nestle SA, Tencent Holdings Ltd, Toyota Motor Corp."]},{"label":"Conservative Mix","description":"Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for a conservative investor.","value":60,"color":"#0785c9","exposures":["Total Bond ETF, S&P 500 ETF, US Treasury Bond ETF"]},{"label":"Enjoy Yourself","description":"Live it up. This ETF includes companies that fuel our fun -- from entertainment, to travel and leisure.","value":9,"color":"#3193d7","exposures":["Delta Airlines, CBS Corp, MGM Resorts International, Las Vegas Sands Corp, Twenty-First Century Fox Inc."]},{"label":"Raw Earth","description":"Fuel the world. This is an investment in companies that mine and process the stuff of the Earth and use it to sustain 7 billion lives.","value":10,"color":"#81bee5","exposures":["BHP Billiton Limited, Syngenta AG, Exxon Mobil Corporation, Royal Dutch Shell, Chevron Corp."]}]},{"name":"The Trendsetter","className":"trendsetter","pieId":"pie-trendsetter","image":"/assets/images/why-stash/trendsetter-circle.jpg","pie":[{"label":"Moderate Mix","description":"Build a foundation. We recommend that every investor start their Stash with a mix. We call them mixes because that’s exactly what they are -- a mixture of stocks and bonds. This mix is designed for a moderate investor.","value":70,"color":"#7bd1ed","exposures":["Total Bond ETF, S&P 500 ETF, US Treasury Bond ETF"]},{"label":"Social Media Mania","description":"Ride the trends. This is an investment in the social media giants that fuel our communication, activism, and entertainment.","value":9,"color":"#2a9ed3","exposures":["Facebook Inc, Tencent Holdings Ltd, Twitter Inc, Alphabet Inc, Pandora Media Inc"]},{"label":"Wireless Wonders","description":"Create connections. This ETF includes companies that build and maintain what we need to live in an interconnected world.","value":10,"color":"#69bfdb","exposures":["AT&T Inc, Verizon Communications Inc, T-Mobile Inc, Sprint Corp, Vonage Holdings Corp."]},{"label":"Retail Therapy","description":"Spur the retail engine. This is an investment in consumer companies that meet our most basic needs and satisfy our material indulgences.","value":10,"color":"#e5e5e5","exposures":["Netflix Inc, Wayfair Inc, Amazon Inc, TripAdvisor Inc, Etsy Inc"]}]}]
var pieSettings = {
	"header": {
		"title": {
			"fontSize": 34,
			"font": "courier"
		},
		"subtitle": {
			"color": "#999999",
			"fontSize": 10,
			"font": "courier"
		},
		"location": "pie-center",
		"titleSubtitlePadding": 10
	},
	"footer": {
		"color": "#999999",
		"fontSize": 10,
		"font": "open sans",
		"location": "bottom-left"
	},
	"size": {
		"canvasWidth": 360,
		"canvasHeight": 360,
		"pieInnerRadius": "75%",
		"pieOuterRadius": "87%"
	},
	"data": {
		"sortOrder": "value-asc",
		"content": [/* populate pie data here */]
	},
	"labels": {
		"outer": {
			"format": "none",
			"pieDistance": 20
		},
		"inner": {
			"format": "none"
		},
		"mainLabel": {
			"fontSize": 11
		},
		"percentage": {
			"color": "#999999",
			"fontSize": 11,
			"decimalPlaces": 0
		},
		"value": {
			"color": "#cccc43",
			"fontSize": 11
		},
		"lines": {
			"enabled": true,
			"color": "#777777"
		},
		"truncation": {
			"enabled": true
		}
	},
	"effects": {
		"load": {
			"effect": "none"
		},
		"pullOutSegmentOnClick": {
			"effect": "elastic",
			"size": 17
		},
		"highlightLuminosity": 0.05
	},
	"misc": {
		"gradient": {
			"enabled": false,
			"percentage": 20
		}
	},
	"callbacks": {
		"onClickSegment": onClickSegment
	}
};
pieData.map(function(p){
	var settings = pieSettings;
	settings.data.content = p.pie;
	var pie = new d3pie(p.pieId, settings);
	$(document).ready(function(){
	console.log(p.image);
		$('#'+p.pieId+' image').attr('href', p.image)
	});
})

function onClickSegment(segment) {
	!segment.expanded && updateInvestmentText(segment);
}

function updateInvestmentText(d) {
		dataLayer.push({ event: 'ArcClick' })
		var investor = $(d.segment).parents('.investor');
		var pie = $(d.segment).parents('g[class$="pieChart"]');
		//- animateRotate(pie, 360, 600);
		updateTextItem(investor, '.investment-name', d.data.label);
		updateTextItem(investor, '.investment-description', d.data.description);
		updateTextItem(investor, '.investment-exposures', d.data.exposures.join(', '));
}

function updateTextItem(investor, className, text) {
	var duration = 200;
	investor.find(className).fadeOut(duration, function(){$(this).text(text)}).fadeIn(duration);
}

function animateRotate(elem, angle, duration) {
	$({deg: 0}).delay(300).animate({deg: angle}, {
		duration: duration,
		step: function(now) {
			elem.css({
				transform: 'rotate(' + now + 'deg)'
			});
		},
		complete: function() {
			elem.css({
				transform: 'rotate(0deg)'
			});
		}
	});
}

// click first arc of each pie http://stackoverflow.com/questions/9063383/how-to-invoke-click-event-programmatically-in-d3
$(document).ready(function(){
	window.setTimeout(function(){
		$('g[class$="pieChart"] g:first-child').each(function(i, e){
			var evt = new MouseEvent('click');
			e.dispatchEvent(evt);
		})
	}, 1000);

	$('.investments').on('inview', function(e, isInView){
		$(this).addClass('viewed').off('inview');

	})
});</script><footer class="page-footer"><style>footer.page-footer {
  padding-top: 6em;
  color: #fff;
  position: relative;
  z-index: 1;
  letter-spacing: 0.03em;
  background-image: linear-gradient(140deg, rgba(99, 54, 169, 0.5), rgba(59, 231, 228, 0.5)), linear-gradient(137deg, #4a238a, #6175b1);
}
footer.page-footer .footer-wrap {
  padding: 1em 2em 2em;
}
footer.page-footer .footer-wrap p.disclosures {
  font-size: 0.875em;
  margin-bottom: 1em;
}
footer.page-footer .footer-wrap p.disclosures a {
  color: #fff;
}
footer.page-footer .footer-wrap p.disclosures a:hover {
  text-decoration: underline;
}
footer.page-footer .links {
  width: 17%;
  max-width: 9em;
  font-size: 0.875em;
  box-sizing: border-box;
}
footer.page-footer .links p {
  opacity: 0.5;
  text-transform: uppercase;
  font-weight: 600;
  padding-bottom: 0.5em;
}
footer.page-footer .links a {
  color: #fff;
  text-decoration: none;
  display: block;
  padding: 0.3em 0;
}
footer.page-footer .links a:hover {
  text-decoration: underline;
}
footer.page-footer .nav-wrap {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
}
footer.page-footer .app-store {
  width: 28%;
}
footer.page-footer .app-store .badges a {
  display: inline-block;
  height: 45px;
  padding-right: 0;
  margin-right: 7px;
  width: 45%;
  background-size: contain;
  background-position: left;
  background-repeat: no-repeat;
  overflow: hidden;
  color: rgba(0, 0, 0, 0);
}
footer.page-footer .app-store p {
  font-size: 1.5em;
  font-weight: 300;
}
footer.page-footer .app-store .apple {
  background-image: url('https://cdn.stashinvest.com/assets/images/globals/logo-app-store.svg');
}
footer.page-footer .app-store .android {
  background-image: url('https://cdn.stashinvest.com/assets/images/globals/logo-play-store.svg');
}
footer.page-footer div small {
  display: block;
  font-size: 0.75em;
  margin-bottom: 1.5em;
  letter-spacing: 0.05em;
  line-height: 1.7;
}
footer.page-footer div small a {
  text-decoration: none;
  color: #44cfda;
}
footer.page-footer div small a:hover {
  text-decoration: underline;
}
footer.page-footer div small:last-child {
  margin-bottom: 0;
}
/* Socials */
.socials {
  width: 100%;
  padding-top: 1em;
  display: flex;
  justify-content: center;
}
.socials a {
  display: block;
  width: 2.5em;
  height: 2.5em;
  text-indent: -9999px;
  margin: 1em;
  background-repeat: no-repeat;
  background-size: contain;
  background-position: center;
  color: rgba(0, 0, 0, 0);
}
.socials a:hover {
  opacity: .5;
}
.socials .linkedin {
  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogc2tldGNodG9vbCA0MC4zICgzMzgzOSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPkU2QTg1MTRBLUY4OTYtNDI3Ni04MkM2LUU1MEY5QkI4MTBCMDwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIHNrZXRjaHRvb2wuPC9kZXNjPg0KICAgIDxkZWZzPg0KICAgICAgICA8Y2lyY2xlIGlkPSJwYXRoLTEiIGN4PSIxNiIgY3k9IjE2IiByPSIxNiI+PC9jaXJjbGU+DQogICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIG1hc2tDb250ZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBtYXNrVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiB4PSIwIiB5PSIwIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9IndoaXRlIj4NCiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+DQogICAgICAgIDwvbWFzaz4NCiAgICA8L2RlZnM+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyBpZD0iTmF2LS8tZm9vdGVyLWxpbmtzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzQ0LjAwMDAwMCwgLTE2MC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJsaW5rZWRpbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzQ0LjAwMDAwMCwgMTYwLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgIDx1c2UgaWQ9Ik92YWwiIHN0cm9rZT0iI0ZGRkZGRiIgbWFzaz0idXJsKCNtYXNrLTIpIiBzdHJva2Utd2lkdGg9IjIiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPg0KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05LjA5NDE1ODksMTMuMzkxMzU1IEwxMS45MjkxODg0LDEzLjM5MTM1NSBMMTEuOTI5MTg4NCwyMy4yNzE3OTU5IEw5LjA5NDE1ODksMjMuMjcxNzk1OSBMOS4wOTQxNTg5LDEzLjM5MTM1NSBaIE0xMC40Mzk0MDgyLDEyLjE1NTQ4NDkgTDEwLjQxODg4MzEsMTIuMTU1NDg0OSBDOS4zOTI2MjgwNywxMi4xNTU0ODQ5IDguNzI3MjcyNzMsMTEuNDAwMTc5MyA4LjcyNzI3MjczLDEwLjQ0MzcwNzEgQzguNzI3MjcyNzMsOS40Njc2NzcxNiA5LjQxMjI5Nzk2LDguNzI3MjcyNzMgMTAuNDU5MDc4MSw4LjcyNzI3MjczIEMxMS41MDUwMDMsOC43MjcyNzI3MyAxMi4xNDgxMjI4LDkuNDY1ODE0NSAxMi4xNjg2NDc5LDEwLjQ0MDkxMzIgQzEyLjE2ODY0NzksMTEuMzk3Mzg1MyAxMS41MDUwMDMsMTIuMTU1NDg0OSAxMC40Mzk0MDgyLDEyLjE1NTQ4NDkgTDEwLjQzOTQwODIsMTIuMTU1NDg0OSBaIE0yMy4yNzI3MjczLDIzLjI3MjcyNzMgTDIwLjA1Nzk4MzQsMjMuMjcyNzI3MyBMMjAuMDU3OTgzNCwxOC4xNTg4MTQ0IEMyMC4wNTc5ODM0LDE2LjgyMDQ5ODUgMTkuNTU1MTE4NCwxNS45MDc3OTg3IDE4LjQ0OTMyODcsMTUuOTA3Nzk4NyBDMTcuNjAzNTIzNSwxNS45MDc3OTg3IDE3LjEzMzE1NjYsMTYuNTIzNDA1NCAxNi45MTQyMjIyLDE3LjExODUyMjkgQzE2LjgzMjEyMTgsMTcuMzMwODY1MyAxNi44NDQ5NSwxNy42Mjc5NTg0IDE2Ljg0NDk1LDE3LjkyNTk4MjggTDE2Ljg0NDk1LDIzLjI3MjcyNzMgTDEzLjY2MDEzODUsMjMuMjcyNzI3MyBDMTMuNjYwMTM4NSwyMy4yNzI3MjczIDEzLjcwMTE4ODcsMTQuMjE0NjQ3NCAxMy42NjAxMzg1LDEzLjM5MTM1NSBMMTYuODQ0OTUsMTMuMzkxMzU1IEwxNi44NDQ5NSwxNC45NDIwMTMzIEMxNy4wMzMwOTY3LDE0LjI2NDAwNzcgMTguMDUwNzk5NiwxMy4yOTYzNTk3IDE5LjY3NDg0ODIsMTMuMjk2MzU5NyBDMjEuNjg5NzI4OSwxMy4yOTYzNTk3IDIzLjI3MjcyNzMsMTQuNzE4NDk1IDIzLjI3MjcyNzMsMTcuNzc3OTAyIEwyMy4yNzI3MjczLDIzLjI3MjcyNzMgTDIzLjI3MjcyNzMsMjMuMjcyNzI3MyBaIiBpZD0iU2hhcGUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4NCiAgICAgICAgICAgIDwvZz4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==');
}
.socials .facebook {
  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogc2tldGNodG9vbCA0MC4zICgzMzgzOSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPjU5NjdBMjIwLTZFQzAtNDZENi04QTk5LTEyMjI1NzZBODQyQTwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIHNrZXRjaHRvb2wuPC9kZXNjPg0KICAgIDxkZWZzPg0KICAgICAgICA8Y2lyY2xlIGlkPSJwYXRoLTEiIGN4PSIxNiIgY3k9IjE2IiByPSIxNiI+PC9jaXJjbGU+DQogICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIG1hc2tDb250ZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBtYXNrVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiB4PSIwIiB5PSIwIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9IndoaXRlIj4NCiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+DQogICAgICAgIDwvbWFzaz4NCiAgICA8L2RlZnM+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyBpZD0iTmF2LS8tZm9vdGVyLWxpbmtzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTc2LjAwMDAwMCwgLTE2MC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJmYWNlYm9vayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTc2LjAwMDAwMCwgMTYwLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgIDx1c2UgaWQ9Ik92YWwiIHN0cm9rZT0iI0ZGRkZGRiIgbWFzaz0idXJsKCNtYXNrLTIpIiBzdHJva2Utd2lkdGg9IjIiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPg0KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNi45NTYxNDk2LDI1LjQ1NDU0NTUgTDEzLjQwODkwMzEsMjUuNDU0NTQ1NSBMMTMuNDA4OTAzMSwxNy4wODk4NTMzIEwxMS42MzYzNjM2LDE3LjA4OTg1MzMgTDExLjYzNjM2MzYsMTQuMjA3NjYxMSBMMTMuNDA4OTAzMSwxNC4yMDc2NjExIEwxMy40MDg5MDMxLDEyLjQ3NzI4OTkgQzEzLjQwODkwMzEsMTAuMTI2MTM4OSAxNC40MDkyNDE4LDguNzI3MjcyNzMgMTcuMjUzMTA4Miw4LjcyNzI3MjczIEwxOS42MjAxMDY4LDguNzI3MjcyNzMgTDE5LjYyMDEwNjgsMTEuNjEwNTIwOCBMMTguMTQwNzMyNywxMS42MTA1MjA4IEMxNy4wMzM2NDA2LDExLjYxMDUyMDggMTYuOTYwNDg0NywxMi4wMTMyODg3IDE2Ljk2MDQ4NDcsMTIuNzY0OTgxMyBMMTYuOTU1NjA3NywxNC4yMDc2NjExIEwxOS42MzYzNjM2LDE0LjIwNzY2MTEgTDE5LjMyMjYwNjMsMTcuMDg5ODUzMyBMMTYuOTU1NjA3NywxNy4wODk4NTMzIEwxNi45NTU2MDc3LDI1LjQ1NDU0NTUgTDE2Ljk1NjE0OTYsMjUuNDU0NTQ1NSBaIiBpZD0iU2hhcGUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4NCiAgICAgICAgICAgIDwvZz4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==');
}
.socials .twitter {
  background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogc2tldGNodG9vbCA0MC4zICgzMzgzOSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPjk0MTZERTdBLTZCMUYtNEUwNC04MTcyLUQ2QUIxMkI1MUNBNTwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIHNrZXRjaHRvb2wuPC9kZXNjPg0KICAgIDxkZWZzPg0KICAgICAgICA8Y2lyY2xlIGlkPSJwYXRoLTEiIGN4PSIxNiIgY3k9IjE2IiByPSIxNiI+PC9jaXJjbGU+DQogICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIG1hc2tDb250ZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBtYXNrVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiB4PSIwIiB5PSIwIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9IndoaXRlIj4NCiAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+DQogICAgICAgIDwvbWFzaz4NCiAgICA8L2RlZnM+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPg0KICAgICAgICA8ZyBpZD0iTmF2LS8tZm9vdGVyLWxpbmtzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjMyLjAwMDAwMCwgLTE2MC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJ0d2l0dGVyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MzIuMDAwMDAwLCAxNjAuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj48L3JlY3Q+DQogICAgICAgICAgICAgICAgPHVzZSBpZD0iT3ZhbCIgc3Ryb2tlPSIjRkZGRkZGIiBtYXNrPSJ1cmwoI21hc2stMikiIHN0cm9rZS13aWR0aD0iMiIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+DQogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIyLjIwMDgzNTYsMTIuMjUxNDQxMiBDMjIuODQ4MDY4NiwxMS44NDMwMDAzIDIzLjM0NDY5OSwxMS4xOTUzNTY3IDIzLjU3Nzc3NDYsMTAuNDIzODU3MiBDMjIuOTcxNzc4LDEwLjgwMjk4ODcgMjIuMzAyMTMzOSwxMS4wNzcxNzM2IDIxLjU4NzY2NzUsMTEuMjI1NjExNiBDMjEuMDE3NTI4NywxMC41ODI2OTU0IDIwLjIwMjY2MDUsMTAuMTgxODE4MiAxOS4zMDA4MzcyLDEwLjE4MTgxODIgQzE3LjU3MDY5OTEsMTAuMTgxODE4MiAxNi4xNjg2NTk3LDExLjY2MTQ3MSAxNi4xNjg2NTk3LDEzLjQ4NjIxODUgQzE2LjE2ODY1OTcsMTMuNzQ1Mjc2IDE2LjE5NDY1NjUsMTMuOTk3NzE1MSAxNi4yNDg0NDMyLDE0LjIzODgwODcgQzEzLjY0NTE2OCwxNC4xMDA3NzA4IDExLjMzNjgyMzEsMTIuNzg2NTc0NCA5Ljc5MDQ1NjA3LDEwLjc4NTk3MDMgQzkuNTIwNjI2MjMsMTEuMjc1NzIxMiA5LjM2NjQzNzc1LDExLjg0MzAwMDMgOS4zNjY0Mzc3NSwxMi40NDgwOTc5IEM5LjM2NjQzNzc1LDEzLjU5NDAwMTUgOS45MTk1NDQwOSwxNC42MDU2NDkyIDEwLjc2MDQwOTIsMTUuMTk5NDAxMiBDMTAuMjQ2NzQ2NCwxNS4xODIzODI4IDkuNzYzNTYyNzMsMTUuMDMyMDUzOSA5LjM0MDQ0MDg2LDE0Ljc4NjIzMyBMOS4zNDA0NDA4NiwxNC44MjY4ODggQzkuMzQwNDQwODYsMTYuNDI4NTA1OCAxMC40MTk3NjAyLDE3Ljc2NDQ0NzkgMTEuODU0OTY4MSwxOC4wNjY5OTY3IEMxMS41OTE0MTMzLDE4LjE0NDUyNDggMTEuMzE1MzA4NCwxOC4xODMyODg5IDExLjAyODQ0NjEsMTguMTgzMjg4OSBDMTAuODI2NzQ2MSwxOC4xODMyODg5IDEwLjYyOTUyODIsMTguMTYzNDM0MSAxMC40Mzk0ODIsMTguMTI0NjcwMSBDMTAuODM3NTAzNCwxOS40MzY5NzU2IDExLjk5NDgxMzQsMjAuMzkzNzg2MiAxMy4zNjYzNzM3LDIwLjQxOTMxMzcgQzEyLjI5MzMyOTUsMjEuMzA2MTYgMTAuOTQyMzg3NCwyMS44MzM3Mjk1IDkuNDc0OTA3NTUsMjEuODMzNzI5NSBDOS4yMjIxMTAxNywyMS44MzM3Mjk1IDguOTcyMDAyMTEsMjEuODE5NTQ3NSA4LjcyNzI3MjczLDIxLjc4ODM0NzEgQzEwLjExNDA3MjYsMjIuNzI1MzAzIDExLjc2MDg0MTQsMjMuMjcyNzI3MyAxMy41MzA0MjMxLDIzLjI3MjcyNzMgQzE5LjI5NDU2MjEsMjMuMjcyNzI3MyAyMi40NDQ2Njg2LDE4LjIzNzE4MDQgMjIuNDQ0NjY4NiwxMy44NzAwNzczIEMyMi40NDQ2Njg2LDEzLjcyNjM2NjcgMjIuNDQyODc1NywxMy41ODM2MDE0IDIyLjQzNjYwMDYsMTMuNDQyNzI3MSBDMjMuMDQ4ODcyMiwxMi45NzY2MTI5IDIzLjU4MTM2MDQsMTIuMzk0MjA2NCAyNCwxMS43MzE0MzU0IEMyMy40Mzc5MjkyLDExLjk5NDI3NDcgMjIuODMzNzI1NSwxMi4xNzIwMjIxIDIyLjIwMDgzNTYsMTIuMjUxNDQxMiBaIiBpZD0iU2hhcGUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4NCiAgICAgICAgICAgIDwvZz4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==');
}
.socials .instagram {
  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzJweCIgaGVpZ2h0PSIzMnB4IiB2aWV3Qm94PSIwIDAgMzIgMzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IHNrZXRjaHRvb2wgNDAuMyAoMzM4MzkpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT4yQ0E2RTIxNy02NjZDLTRDRTAtOTg3MC1CQjlBOEMyQTkyNkU8L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBza2V0Y2h0b29sLjwvZGVzYz4NCiAgICA8ZGVmcz4NCiAgICAgICAgPGNpcmNsZSBpZD0icGF0aC0xIiBjeD0iMTYiIGN5PSIxNiIgcj0iMTYiPjwvY2lyY2xlPg0KICAgICAgICA8bWFzayBpZD0ibWFzay0yIiBtYXNrQ29udGVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgbWFza1VuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSJ3aGl0ZSI+DQogICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPg0KICAgICAgICA8L21hc2s+DQogICAgPC9kZWZzPg0KICAgIDxnIGlkPSJTeW1ib2xzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9Ik5hdi0vLWZvb3Rlci1saW5rcyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTY4OC4wMDAwMDAsIC0xNjAuMDAwMDAwKSI+DQogICAgICAgICAgICA8ZyBpZD0iaW5zdGFncmFtIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2ODguMDAwMDAwLCAxNjAuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj48L3JlY3Q+DQogICAgICAgICAgICAgICAgPHVzZSBpZD0iT3ZhbCIgc3Ryb2tlPSIjRkZGRkZGIiBtYXNrPSJ1cmwoI21hc2stMikiIHN0cm9rZS13aWR0aD0iMiIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+DQogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIwLjQ2MTY0MzcsOC43MjcyNzI3MyBMMTEuNTM4MzU2Myw4LjcyNzI3MjczIEM5Ljk4ODcxMTE5LDguNzI3MjcyNzMgOC43MjcyNzI3Myw5Ljk4Nzg1NTk4IDguNzI3MjcyNzMsMTEuNTM4MzU2MyBMOC43MjcyNzI3MywyMC40NjE2NDM3IEM4LjcyNzI3MjczLDIyLjAxMjE0NCA5Ljk4ODcxMTE5LDIzLjI3MjcyNzMgMTEuNTM4MzU2MywyMy4yNzI3MjczIEwyMC40NjE2NDM3LDIzLjI3MjcyNzMgQzIyLjAxMTI4ODgsMjMuMjcyNzI3MyAyMy4yNzI3MjczLDIyLjAxMjE0NCAyMy4yNzI3MjczLDIwLjQ2MTY0MzcgTDIzLjI3MjcyNzMsMTEuNTM4MzU2MyBDMjMuMjcyNzI3Myw5Ljk4Nzg1NTk4IDIyLjAxMTI4ODgsOC43MjcyNzI3MyAyMC40NjE2NDM3LDguNzI3MjcyNzMgTDIwLjQ2MTY0MzcsOC43MjcyNzI3MyBaIE0yMS4yNjgxMDkxLDEwLjQwNDM0NDUgTDIxLjU4OTY2OSwxMC40MDI2MzQxIEwyMS41ODk2NjksMTIuODY4MjExOCBMMTkuMTMxNzg4MiwxMi44NzU5MDg3IEwxOS4xMjMyMzYxLDEwLjQxMDMzMSBMMjEuMjY4MTA5MSwxMC40MDQzNDQ1IEwyMS4yNjgxMDkxLDEwLjQwNDM0NDUgWiBNMTMuOTI0Mzk5MiwxNC41MDY3OTg5IEMxNC4zODk2MzQ4LDEzLjg2MTk2ODcgMTUuMTQ1NjQyNywxMy40Mzk0OTM3IDE2LDEzLjQzOTQ5MzcgQzE2Ljg1NDM1NzMsMTMuNDM5NDkzNyAxNy42MTAzNjUyLDEzLjg2MTk2ODcgMTguMDc1NjAwOCwxNC41MDY3OTg5IEMxOC4zNzkyMDEyLDE0LjkyNzU2MzUgMTguNTYwNTA2MywxNS40NDI0MDE0IDE4LjU2MDUwNjMsMTYgQzE4LjU2MDUwNjMsMTcuNDExMTAwNyAxNy40MTE5NTU5LDE4LjU1OTY1MTEgMTYsMTguNTU5NjUxMSBDMTQuNTg4ODk5MywxOC41NTk2NTExIDEzLjQ0MDM0ODksMTcuNDExMTAwNyAxMy40NDAzNDg5LDE2IEMxMy40NDAzNDg5LDE1LjQ0MjQwMTQgMTMuNjIxNjU0LDE0LjkyNzU2MzUgMTMuOTI0Mzk5MiwxNC41MDY3OTg5IEwxMy45MjQzOTkyLDE0LjUwNjc5ODkgWiBNMjEuODU1NjQwMSwyMC40NjE2NDM3IEMyMS44NTU2NDAxLDIxLjIzMDQ3OTggMjEuMjMwNDc5OCwyMS44NTU2NDAxIDIwLjQ2MTY0MzcsMjEuODU1NjQwMSBMMTEuNTM4MzU2MywyMS44NTU2NDAxIEMxMC43Njk1MjAyLDIxLjg1NTY0MDEgMTAuMTQ0MzU5OSwyMS4yMzA0Nzk4IDEwLjE0NDM1OTksMjAuNDYxNjQzNyBMMTAuMTQ0MzU5OSwxNC41MDY3OTg5IEwxMi4zMTY1OTk3LDE0LjUwNjc5ODkgQzEyLjEyODQ1MjksMTQuOTY4NjEzNyAxMi4wMjMyNjE4LDE1LjQ3MjMzMzkgMTIuMDIzMjYxOCwxNiBDMTIuMDIzMjYxOCwxOC4xOTI3NjQ5IDEzLjgwNzIzNTEsMTkuOTc3NTkzNCAxNiwxOS45Nzc1OTM0IEMxOC4xOTM2MjAxLDE5Ljk3NzU5MzQgMTkuOTc3NTkzNCwxOC4xOTI3NjQ5IDE5Ljk3NzU5MzQsMTYgQzE5Ljk3NzU5MzQsMTUuNDcyMzMzOSAxOS44NzA2OTE5LDE0Ljk2ODYxMzcgMTkuNjg0MjU1NSwxNC41MDY3OTg5IEwyMS44NTU2NDAxLDE0LjUwNjc5ODkgTDIxLjg1NTY0MDEsMjAuNDYxNjQzNyBMMjEuODU1NjQwMSwyMC40NjE2NDM3IFoiIGlkPSJTaGFwZSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+');
}
/* phone view, reshuffle footer */
@media only screen and (max-width: 767px) {
  footer.page-footer {
    padding-top: 4em;
  }
  footer.page-footer .socials {
    order: 3;
    width: 100%;
    padding: 1em 0;
    margin: 1em 0;
  }
  footer.page-footer .socials a {
    width: 2em;
    height: 2em;
  }
  footer.page-footer .app-store {
    order: 1;
    width: 100%;
    text-align: center;
    margin-bottom: 1em;
    padding-bottom: 1.5em;
    border-bottom: 2px solid rgba(255, 255, 255, 0.11);
  }
  footer.page-footer .app-store .badges {
    margin: 0 auto;
    max-width: 20em;
  }
  footer.page-footer .app-store .badges a {
    background-position: center;
  }
  footer.page-footer .links {
    order: 2;
    width: 100%;
    max-width: initial;
    margin: 1em 0;
  }
  footer.page-footer .links a {
    padding: 3px 0;
  }
}
</style><div class="nav-bar"><nav class="nav-wrap footer-wrap wrap"><div class="links"><p>Our Company</p><a href="/about-us">About Us</a><a href="/press">Press</a><a href="/careers">Careers</a></div><div class="links"><p>Learn more</p><a href="/why-stash">Why Stash?</a><a href="/pricing">Pricing</a><a href="https://learn.stashinvest.com/">Learn</a></div><div class="links"><p>Questions?</p><a href="https://ask.stashinvest.com/">FAQ</a><a href="https://www.stashinvest.com/quick-start-guide">Quick Start Guide</a><a href="https://ask.stashinvest.com/contact/">Contact Us</a><a href="/security">Security</a></div><div class="links"><p>More Services</p><a href="/for-employers">Stash For Business</a><a href="/retire">Stash Retire</a></div><div class="app-store"><div class="badges"><a class="apple footer-app-store-link" href="https://itunes.apple.com/us/app/stash-invest-investing-financial/id1017148055?mt=8" target="_blank" rel="noopener noreferrer">Stash Invest App Store</a><a class="android footer-app-store-link" href="https://play.google.com/store/apps/details?id=com.stash.stashinvest&amp;hl=en" target="_blank" rel="noopener noreferrer">Stash Invest Play Store</a></div></div><div class="socials"><a class="facebook" href="https://www.facebook.com/stashinvestapp/" target="_blank" rel="noopener noreferrer">Stash Invest Facebook Page</a><a class="linkedin" href="https://www.linkedin.com/company/stashinvest" target="_blank" rel="noopener noreferrer">Stash Invest LinkedIn Page</a><a class="twitter" href="https://twitter.com/Stash" target="_blank" rel="noopener noreferrer">Stash Invest Twitter Page</a><a class="instagram" href="https://www.instagram.com/stash_app/" target="_blank" rel="noopener noreferrer">Stash Invest Instagram Page</a></div></nav></div><div class="legal"><div class="footer-wrap wrap"><p class="disclosures"><a href="/disclosurelibrary">Legal</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="/theprivacypolicy">Privacy Policy</a></p><small>Stash Investments LLC ("Stash") is an SEC registered investment adviser. By using this website, you accept our <a href="/termsofuse">Terms of Use</a> and <a href="/theprivacypolicy">Privacy Policy</a>. Stash’s investment advisory services are available only to residents of the United States in jurisdictions where Stash is registered. Nothing on this website should be considered an offer, solicitation of an offer, or advice to buy or sell securities. Past performance is no guarantee of future results. Any historical returns, expected returns or probability projections are hypothetical in nature and may not reflect actual future performance. Account holdings are for illustrative purposes only and are not investment recommendations. The content on this website is for informational purposes only and does not constitute a complete description of Stash’s investment advisory services. Certain investments are not suitable for all investors and are not available to all Stash Clients. Stash does not provide financial planning services to individual investors. Before investing, consider your investment objectives and Stash’s <a href="https://stashinvest.desk.com/customer/en/portal/articles/2752741-how-are-fees-calculated-" target="_blank" rel="noopener noreferrer">fees</a> and applicable <a href="https://stashinvest.desk.com/customer/en/portal/articles/2418586-account-maintenance-and-bank-transfer-fees" target="_blank" rel="noopener noreferrer">custodial fees</a>. Brokerage services are provided to Stash Clients by <a href="https://www.apexclearing.com/" target="_blank" rel="noopener noreferrer">Apex Clearing Corporation</a>, an SEC registered broker-dealer and member <a href="http://www.finra.org" target="_blank" rel="noopener noreferrer">FINRA</a>/<a href="http://www.sipc.org" target="_blank" rel="noopener noreferrer">SIPC</a>. Market Data by <a href="http://www.xignite.com/" target="_blank" rel="noopener noreferrer">Xignite</a>. For more information, see our <a href="/disclosurelibrary">disclosures</a>. Reproduced with permission of Yahoo. ©2016 Yahoo. YAHOO! and the Yahoo logo are registered trademarks of Yahoo.</small><small>IMPORTANT: Calculator assumes weekly contributions and no withdrawals for 5, 10 or 20 years. Projections generated regarding the likelihood of various outcomes are hypothetical in nature, provided for educational purposes only, do not reflect actual investment results, are not individualized, are not intended to serve as the primary or sole basis for investment decisions, and are not guarantees of future results. The rate of return on investments can vary widely over time, especially for long term investments including the potential loss of principal. The S&P 500® for the 10 years ending 1/1/2014, had an annual compounded rate of return of 8.06%, including reinvestment of dividends (source: www.standardandpoors.com). Since 1970, the highest 12-month return was 61% (June 1982 through June 1983). The lowest 12-month return was -43% (March 2008 to March 2009).</small><small>*1 month equals 30 days from the date of account sign-up. Other <a href="https://stashinvest.desk.com/customer/en/portal/articles/2418586-account-maintenance-and-bank-transfer-fees" target="_blank" rel="noopener noreferrer">fees</a> may apply.</small><small>Contact: 19 W. 22nd Street, 12th floor, New York, NY 10010. Email: <a href="mailto:support@stashinvest.com">support@stashinvest.com</a> Tel: <a href="tel:8002055164">(800) 205-5164</a></small><small>Information provided by Stash Support is for informational and general educational purposes only and is not investment or financial advice.</small><small>© Copyright 2017 Collective Returns, Inc.</small></div></div></footer></body><script src="/assets/js/main.js"></script></html>